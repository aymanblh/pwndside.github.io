<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Sense | PwndSide</title><meta name=keywords content="privesc,web,linux"><meta name=description content="Linux machine with a website running pfsense which has credentials leak which help us access to the software. Thanks to a command injection we can access as root."><meta name=author content="Ayman Boulaich"><link rel=canonical href=https://canonical.url/to/page><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.3613efbd0b1772781e8f49935e973cae632a7f61471c05b17be155505ccf87b5.css integrity="sha256-NhPvvQsXcngej0mTXpc8rmMqf2FHHAWxe+FVUFzPh7U=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://pwndside.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://pwndside.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://pwndside.github.io/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://pwndside.github.io/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://pwndside.github.io/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="Sense"><meta property="og:description" content="Linux machine with a website running pfsense which has credentials leak which help us access to the software. Thanks to a command injection we can access as root."><meta property="og:type" content="article"><meta property="og:url" content="https://pwndside.github.io/posts/sense-htb/"><meta property="og:image" content="https://pwndside.github.io/%3Cimage%20path/url%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-08-22T12:14:14+02:00"><meta property="article:modified_time" content="2023-08-22T12:14:14+02:00"><meta property="og:site_name" content="PwndSide"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://pwndside.github.io/%3Cimage%20path/url%3E"><meta name=twitter:title content="Sense"><meta name=twitter:description content="Linux machine with a website running pfsense which has credentials leak which help us access to the software. Thanks to a command injection we can access as root."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://pwndside.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Sense","item":"https://pwndside.github.io/posts/sense-htb/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Sense","name":"Sense","description":"Linux machine with a website running pfsense which has credentials leak which help us access to the software. Thanks to a command injection we can access as root.","keywords":["privesc","web","linux"],"articleBody":"Room Information Room name: Sense Difficulty level: Easy Room link: https://app.hackthebox.com/machines/Sense Tools Used nmap searchsploit burpsuite Port Scanning sudo nmap $IP -n -Pn -vvv --min-rate 5000 6 │ PORT STATE SERVICE REASON VERSION 7 │ 80/tcp open http syn-ack ttl 63 lighttpd 1.4.35 8 │ |_http-server-header: lighttpd/1.4.35 9 │ | http-methods: 10 │ |_ Supported Methods: GET HEAD POST OPTIONS 11 │ |_http-title: Did not follow redirect to https://10.10.10.60/ 12 │ 443/tcp open ssl/http syn-ack ttl 63 lighttpd 1.4.35 13 │ |_ssl-date: TLS randomness does not represent time 14 │ |_http-favicon: Unknown favicon MD5: 082559A7867CF27ACAB7E9867A8B320F 15 │ |_http-title: Login 16 │ | http-methods: 17 │ |_ Supported Methods: GET HEAD POST OPTIONS 18 │ |_http-server-header: lighttpd/1.4.35 19 │ | ssl-cert: Subject: commonName=Common Name (eg, YOUR name)/organizatio │ nName=CompanyName/stateOrProvinceName=Somewhere/countryName=US/organiza │ tionalUnitName=Organizational Unit Name (eg, section)/emailAddress=Emai │ l Address/localityName=Somecity 20 │ | Issuer: commonName=Common Name (eg, YOUR name)/organizationName=Compa │ nyName/stateOrProvinceName=Somewhere/countryName=US/organizationalUnitN │ ame=Organizational Unit Name (eg, section)/emailAddress=Email Address/l │ ocalityName=Somecity 21 │ | Public Key type: rsa 22 │ | Public Key bits: 1024 23 │ | Signature Algorithm: sha256WithRSAEncryption 24 │ | Not valid before: 2017-10-14T19:21:35 25 │ | Not valid after: 2023-04-06T19:21:35 26 │ | MD5: 65f8:b00f:57d2:3468:2c52:0f44:8110:c622 27 │ | SHA-1: 4f7c:9a75:cb7f:70d3:8087:08cb:8c27:20dc:05f1:bb02 28 │ | -----BEGIN CERTIFICATE----- 29 │ | MIIEKDCCA5GgAwIBAgIJALChaIpiwz41MA0GCSqGSIb3DQEBCwUAMIG/MQswCQYD 30 │ | VQQGEwJVUzESMBAGA1UECBMJU29tZXdoZXJlMREwDwYDVQQHEwhTb21lY2l0eTEU 31 │ | MBIGA1UEChMLQ29tcGFueU5hbWUxLzAtBgNVBAsTJk9yZ2FuaXphdGlvbmFsIFVu 32 │ | aXQgTmFtZSAoZWcsIHNlY3Rpb24pMSQwIgYDVQQDExtDb21tb24gTmFtZSAoZWcs 33 │ | IFlPVVIgbmFtZSkxHDAaBgkqhkiG9w0BCQEWDUVtYWlsIEFkZHJlc3MwHhcNMTcx 34 │ | MDE0MTkyMTM1WhcNMjMwNDA2MTkyMTM1WjCBvzELMAkGA1UEBhMCVVMxEjAQBgNV 35 │ | BAgTCVNvbWV3aGVyZTERMA8GA1UEBxMIU29tZWNpdHkxFDASBgNVBAoTC0NvbXBh 36 │ | bnlOYW1lMS8wLQYDVQQLEyZPcmdhbml6YXRpb25hbCBVbml0IE5hbWUgKGVnLCBz 37 │ | ZWN0aW9uKTEkMCIGA1UEAxMbQ29tbW9uIE5hbWUgKGVnLCBZT1VSIG5hbWUpMRww 38 │ | GgYJKoZIhvcNAQkBFg1FbWFpbCBBZGRyZXNzMIGfMA0GCSqGSIb3DQEBAQUAA4GN 39 │ | ADCBiQKBgQC/sWU6By08lGbvttAfx47SWksgA7FavNrEoW9IRp0W/RF9Fp5BQesL 40 │ | L3FMJ0MHyGcfRhnL5VwDCL0E+1Y05az8PY8kUmjvxSvxQCLn6Mh3nTZkiAJ8vpB0 41 │ | WAnjltrTCEsv7Dnz2OofkpqaUnoNGfO3uKWPvRXl9OlSe/BcDStffQIDAQABo4IB 42 │ | KDCCASQwHQYDVR0OBBYEFDK5DS/hTsi9SHxT749Od/p3Lq05MIH0BgNVHSMEgeww 43 │ | gemAFDK5DS/hTsi9SHxT749Od/p3Lq05oYHFpIHCMIG/MQswCQYDVQQGEwJVUzES 44 │ | MBAGA1UECBMJU29tZXdoZXJlMREwDwYDVQQHEwhTb21lY2l0eTEUMBIGA1UEChML 45 │ | Q29tcGFueU5hbWUxLzAtBgNVBAsTJk9yZ2FuaXphdGlvbmFsIFVuaXQgTmFtZSAo 46 │ | ZWcsIHNlY3Rpb24pMSQwIgYDVQQDExtDb21tb24gTmFtZSAoZWcsIFlPVVIgbmFt 47 │ | ZSkxHDAaBgkqhkiG9w0BCQEWDUVtYWlsIEFkZHJlc3OCCQCwoWiKYsM+NTAMBgNV 48 │ | HRMEBTADAQH/MA0GCSqGSIb3DQEBCwUAA4GBAHNn+1AX2qwJ9zhgN3I4ES1Vq84l 49 │ | n6p7OoBefxcf31Pn3VDnbvJJFFcZdplDxbIWh5lyjpTHRJQyHECtEMW677rFXJAl 50 │ | /cEYWHDndn9Gwaxn7JyffK5lUAPMPEDtudQb3cxrevP/iFZwefi2d5p3jFkDCcGI 51 │ | +Y0tZRIRzHWgQHa/ 52 │ |_-----END CERTIFICATE----- We have two open ports, one with http and one with https.\nEnumeration When I access to the http page seems to redirect you to the ssl one.\nThis will be our only point of entry. If we look at the page there is a pfsense login form.\nInvestigating on google I found that pfsense is a firewall/router computer software distribution based on FreeBSD.\nSearching for default credentials, I found admin/pfsense.\nI am not able to access with them so maybe they changed the passwords.\nOnly I can do now is to fuzz in order to obtain something else.\n1 │ /index.html/ (Status: 200) [Size: 329] 2 │ /index.php/ (Status: 200) [Size: 6690] 3 │ /help.php/ (Status: 200) [Size: 6689] 4 │ /stats.php/ (Status: 200) [Size: 6690] 5 │ /edit.php/ (Status: 200) [Size: 6689] 6 │ /license.php/ (Status: 200) [Size: 6692] 7 │ /system.php/ (Status: 200) [Size: 6691] 8 │ /status.php/ (Status: 200) [Size: 6691] 9 │ /changelog.txt/ (Status: 200) [Size: 271] 10 │ /system-users.txt/ (Status: 200) [Size: 100] 11 │ /exec.php/ (Status: 200) [Size: 6689] 12 │ /graph.php/ (Status: 200) [Size: 6690] 13 │ /tree/ (Status: 200) [Size: 7492] 14 │ /gui.css/ (Status: 200) [Size: 6590] 15 │ /wizard.php/ (Status: 200) [Size: 6691] 16 │ /pkg.php/ (Status: 200) [Size: 6688] 17 │ /installer/ (Status: 302) [Size: 0] [--\u003e installer.php] 18 │ /xmlrpc.php/ (Status: 200) [Size: 384] 19 │ /treeview.css/ (Status: 200) [Size: 726] The scan results gives us two interesting directories /changelog.txt and /system-users.txt\nIn /changelog.txt directory we found information about security stuff, basically told us that there is one vulnerability which it isn’t patched yet.\nThe /system-users.txt gives us a. credentials, maybe we can try to access with them in the main login page.\nExploiting We have the current software version of pfsense which we are using. Let’s search any exploit.\nWe only have one which seems a command injection vuln.\nThe exploit seems to automatize the things.\nThe script doesn’t worked for me, so I decided to see how works to gain access by myself.\nexploit_url = \"https://\" + rhost + \"/status_rrd_graph_img.php?database=queues;\"+\"printf+\" + \"'\" + payload + \"'|sh\" The script basically access to the above url and put a payload with a reverse shell, so let’s make it with burp repeater.\nThe following requests seems to work, its a basic injection to ensure that we have command injection\nOnce insured about that there is a command injection. Let’s see what user is executing the commands, I put a nc listener in order to see the output.\nGood we are root so let’s put a reverse shell to gain access to the machine.\nSomething is not working, maybe some kind of character is not covered\nWith the above injection the / character is not outputted.\nI tried the same injection with a bunch of characters and the ones are not outputted are / and -\nWe can pass this characters octal code to a variable and use the variable in order to execute the reverse shell.\nGaining an Initial Foothold We owned the system, this machine doesn’t need privesc as we can see.\nLet’s cat the user’s flag.\nLet’s cat the root’s flag.\nThank you for reading, and happy hacking! 😄\n","wordCount":"835","inLanguage":"en","image":"https://pwndside.github.io/%3Cimage%20path/url%3E","datePublished":"2023-08-22T12:14:14+02:00","dateModified":"2023-08-22T12:14:14+02:00","author":{"@type":"Person","name":"Ayman Boulaich"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://pwndside.github.io/posts/sense-htb/"},"publisher":{"@type":"Organization","name":"PwndSide","logo":{"@type":"ImageObject","url":"https://pwndside.github.io/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://pwndside.github.io/ accesskey=h title="PwndSide (Alt + H)"><img src=https://pwndside.github.io/apple-touch-icon.png alt aria-label=logo height=35>PwndSide</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://pwndside.github.io/categories/hackthebox title=HackTheBox><span>HackTheBox</span></a></li><li><a href=https://pwndside.github.io/categories/ctf title="CTF's"><span>CTF's</span></a></li><li><a href=https://pwndside.github.io/about/whoami/ title=whoami><span>whoami</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://pwndside.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://pwndside.github.io/posts/>Posts</a></div><h1 class=post-title>Sense</h1><div class=post-description>Linux machine with a website running pfsense which has credentials leak which help us access to the software. Thanks to a command injection we can access as root.</div><div class=post-meta><span title='2023-08-22 12:14:14 +0200 CEST'>August 22, 2023</span>&nbsp;·&nbsp;4 min&nbsp;·&nbsp;835 words&nbsp;·&nbsp;Ayman Boulaich&nbsp;|&nbsp;<a href=https://github.com/pwndside/pwndside.github.io/content/posts/sense-htb.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#room-information>Room Information</a></li><li><a href=#tools-used>Tools Used</a></li><li><a href=#port-scanning>Port Scanning</a></li><li><a href=#enumeration>Enumeration</a></li><li><a href=#exploiting>Exploiting</a></li><li><a href=#gaining-an-initial-foothold>Gaining an Initial Foothold</a></li></ul></nav></div></details></div><div class=post-content><h2 id=room-information>Room Information<a hidden class=anchor aria-hidden=true href=#room-information>#</a></h2><ul><li>Room name: Sense</li><li>Difficulty level: Easy</li><li>Room link: <a href=https://app.hackthebox.com/machines/Sense>https://app.hackthebox.com/machines/Sense</a></li></ul><p><img loading=lazy src=/HTB/sense-icon.png alt=Untitled></p><h2 id=tools-used>Tools Used<a hidden class=anchor aria-hidden=true href=#tools-used>#</a></h2><ul><li>nmap</li><li>searchsploit</li><li>burpsuite</li></ul><h2 id=port-scanning>Port Scanning<a hidden class=anchor aria-hidden=true href=#port-scanning>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo nmap <span class=nv>$IP</span> -n -Pn -vvv --min-rate <span class=m>5000</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>   <span class=m>6</span>   │ PORT    STATE SERVICE  REASON         VERSION
</span></span><span class=line><span class=cl>   <span class=m>7</span>   │ 80/tcp  open  http     syn-ack ttl <span class=m>63</span> lighttpd 1.4.35
</span></span><span class=line><span class=cl>   <span class=m>8</span>   │ <span class=p>|</span>_http-server-header: lighttpd/1.4.35
</span></span><span class=line><span class=cl>   <span class=m>9</span>   │ <span class=p>|</span> http-methods:
</span></span><span class=line><span class=cl>  <span class=m>10</span>   │ <span class=p>|</span>_  Supported Methods: GET HEAD POST OPTIONS
</span></span><span class=line><span class=cl>  <span class=m>11</span>   │ <span class=p>|</span>_http-title: Did not follow redirect to https://10.10.10.60/
</span></span><span class=line><span class=cl>  <span class=m>12</span>   │ 443/tcp open  ssl/http syn-ack ttl <span class=m>63</span> lighttpd 1.4.35
</span></span><span class=line><span class=cl>  <span class=m>13</span>   │ <span class=p>|</span>_ssl-date: TLS randomness does not represent <span class=nb>time</span>
</span></span><span class=line><span class=cl>  <span class=m>14</span>   │ <span class=p>|</span>_http-favicon: Unknown favicon MD5: 082559A7867CF27ACAB7E9867A8B320F
</span></span><span class=line><span class=cl>  <span class=m>15</span>   │ <span class=p>|</span>_http-title: Login
</span></span><span class=line><span class=cl>  <span class=m>16</span>   │ <span class=p>|</span> http-methods:
</span></span><span class=line><span class=cl>  <span class=m>17</span>   │ <span class=p>|</span>_  Supported Methods: GET HEAD POST OPTIONS
</span></span><span class=line><span class=cl>  <span class=m>18</span>   │ <span class=p>|</span>_http-server-header: lighttpd/1.4.35
</span></span><span class=line><span class=cl>  <span class=m>19</span>   │ <span class=p>|</span> ssl-cert: Subject: <span class=nv>commonName</span><span class=o>=</span>Common Name <span class=o>(</span>eg, YOUR name<span class=o>)</span>/organizatio
</span></span><span class=line><span class=cl>       │ <span class=nv>nName</span><span class=o>=</span>CompanyName/stateOrProvinceName<span class=o>=</span>Somewhere/countryName<span class=o>=</span>US/organiza
</span></span><span class=line><span class=cl>       │ <span class=nv>tionalUnitName</span><span class=o>=</span>Organizational Unit Name <span class=o>(</span>eg, section<span class=o>)</span>/emailAddress<span class=o>=</span>Emai
</span></span><span class=line><span class=cl>       │ l Address/localityName<span class=o>=</span>Somecity
</span></span><span class=line><span class=cl>  <span class=m>20</span>   │ <span class=p>|</span> Issuer: <span class=nv>commonName</span><span class=o>=</span>Common Name <span class=o>(</span>eg, YOUR name<span class=o>)</span>/organizationName<span class=o>=</span>Compa
</span></span><span class=line><span class=cl>       │ nyName/stateOrProvinceName<span class=o>=</span>Somewhere/countryName<span class=o>=</span>US/organizationalUnitN
</span></span><span class=line><span class=cl>       │ <span class=nv>ame</span><span class=o>=</span>Organizational Unit Name <span class=o>(</span>eg, section<span class=o>)</span>/emailAddress<span class=o>=</span>Email Address/l
</span></span><span class=line><span class=cl>       │ <span class=nv>ocalityName</span><span class=o>=</span>Somecity
</span></span><span class=line><span class=cl>  <span class=m>21</span>   │ <span class=p>|</span> Public Key type: rsa
</span></span><span class=line><span class=cl>  <span class=m>22</span>   │ <span class=p>|</span> Public Key bits: <span class=m>1024</span>
</span></span><span class=line><span class=cl>  <span class=m>23</span>   │ <span class=p>|</span> Signature Algorithm: sha256WithRSAEncryption
</span></span><span class=line><span class=cl>  <span class=m>24</span>   │ <span class=p>|</span> Not valid before: 2017-10-14T19:21:35
</span></span><span class=line><span class=cl>  <span class=m>25</span>   │ <span class=p>|</span> Not valid after:  2023-04-06T19:21:35
</span></span><span class=line><span class=cl>  <span class=m>26</span>   │ <span class=p>|</span> MD5:   65f8:b00f:57d2:3468:2c52:0f44:8110:c622
</span></span><span class=line><span class=cl>  <span class=m>27</span>   │ <span class=p>|</span> SHA-1: 4f7c:9a75:cb7f:70d3:8087:08cb:8c27:20dc:05f1:bb02
</span></span><span class=line><span class=cl>  <span class=m>28</span>   │ <span class=p>|</span> -----BEGIN CERTIFICATE-----
</span></span><span class=line><span class=cl>  <span class=m>29</span>   │ <span class=p>|</span> MIIEKDCCA5GgAwIBAgIJALChaIpiwz41MA0GCSqGSIb3DQEBCwUAMIG/MQswCQYD
</span></span><span class=line><span class=cl>  <span class=m>30</span>   │ <span class=p>|</span> VQQGEwJVUzESMBAGA1UECBMJU29tZXdoZXJlMREwDwYDVQQHEwhTb21lY2l0eTEU
</span></span><span class=line><span class=cl>  <span class=m>31</span>   │ <span class=p>|</span> MBIGA1UEChMLQ29tcGFueU5hbWUxLzAtBgNVBAsTJk9yZ2FuaXphdGlvbmFsIFVu
</span></span><span class=line><span class=cl>  <span class=m>32</span>   │ <span class=p>|</span> aXQgTmFtZSAoZWcsIHNlY3Rpb24pMSQwIgYDVQQDExtDb21tb24gTmFtZSAoZWcs
</span></span><span class=line><span class=cl>  <span class=m>33</span>   │ <span class=p>|</span> IFlPVVIgbmFtZSkxHDAaBgkqhkiG9w0BCQEWDUVtYWlsIEFkZHJlc3MwHhcNMTcx
</span></span><span class=line><span class=cl>  <span class=m>34</span>   │ <span class=p>|</span> MDE0MTkyMTM1WhcNMjMwNDA2MTkyMTM1WjCBvzELMAkGA1UEBhMCVVMxEjAQBgNV
</span></span><span class=line><span class=cl>  <span class=m>35</span>   │ <span class=p>|</span> BAgTCVNvbWV3aGVyZTERMA8GA1UEBxMIU29tZWNpdHkxFDASBgNVBAoTC0NvbXBh
</span></span><span class=line><span class=cl>  <span class=m>36</span>   │ <span class=p>|</span> bnlOYW1lMS8wLQYDVQQLEyZPcmdhbml6YXRpb25hbCBVbml0IE5hbWUgKGVnLCBz
</span></span><span class=line><span class=cl>  <span class=m>37</span>   │ <span class=p>|</span> ZWN0aW9uKTEkMCIGA1UEAxMbQ29tbW9uIE5hbWUgKGVnLCBZT1VSIG5hbWUpMRww
</span></span><span class=line><span class=cl>  <span class=m>38</span>   │ <span class=p>|</span> GgYJKoZIhvcNAQkBFg1FbWFpbCBBZGRyZXNzMIGfMA0GCSqGSIb3DQEBAQUAA4GN
</span></span><span class=line><span class=cl>  <span class=m>39</span>   │ <span class=p>|</span> ADCBiQKBgQC/sWU6By08lGbvttAfx47SWksgA7FavNrEoW9IRp0W/RF9Fp5BQesL
</span></span><span class=line><span class=cl>  <span class=m>40</span>   │ <span class=p>|</span> L3FMJ0MHyGcfRhnL5VwDCL0E+1Y05az8PY8kUmjvxSvxQCLn6Mh3nTZkiAJ8vpB0
</span></span><span class=line><span class=cl>  <span class=m>41</span>   │ <span class=p>|</span> WAnjltrTCEsv7Dnz2OofkpqaUnoNGfO3uKWPvRXl9OlSe/BcDStffQIDAQABo4IB
</span></span><span class=line><span class=cl>  <span class=m>42</span>   │ <span class=p>|</span> KDCCASQwHQYDVR0OBBYEFDK5DS/hTsi9SHxT749Od/p3Lq05MIH0BgNVHSMEgeww
</span></span><span class=line><span class=cl>  <span class=m>43</span>   │ <span class=p>|</span> gemAFDK5DS/hTsi9SHxT749Od/p3Lq05oYHFpIHCMIG/MQswCQYDVQQGEwJVUzES
</span></span><span class=line><span class=cl>  <span class=m>44</span>   │ <span class=p>|</span> MBAGA1UECBMJU29tZXdoZXJlMREwDwYDVQQHEwhTb21lY2l0eTEUMBIGA1UEChML
</span></span><span class=line><span class=cl>  <span class=m>45</span>   │ <span class=p>|</span> Q29tcGFueU5hbWUxLzAtBgNVBAsTJk9yZ2FuaXphdGlvbmFsIFVuaXQgTmFtZSAo
</span></span><span class=line><span class=cl>  <span class=m>46</span>   │ <span class=p>|</span> ZWcsIHNlY3Rpb24pMSQwIgYDVQQDExtDb21tb24gTmFtZSAoZWcsIFlPVVIgbmFt
</span></span><span class=line><span class=cl>  <span class=m>47</span>   │ <span class=p>|</span> ZSkxHDAaBgkqhkiG9w0BCQEWDUVtYWlsIEFkZHJlc3OCCQCwoWiKYsM+NTAMBgNV
</span></span><span class=line><span class=cl>  <span class=m>48</span>   │ <span class=p>|</span> HRMEBTADAQH/MA0GCSqGSIb3DQEBCwUAA4GBAHNn+1AX2qwJ9zhgN3I4ES1Vq84l
</span></span><span class=line><span class=cl>  <span class=m>49</span>   │ <span class=p>|</span> n6p7OoBefxcf31Pn3VDnbvJJFFcZdplDxbIWh5lyjpTHRJQyHECtEMW677rFXJAl
</span></span><span class=line><span class=cl>  <span class=m>50</span>   │ <span class=p>|</span> /cEYWHDndn9Gwaxn7JyffK5lUAPMPEDtudQb3cxrevP/iFZwefi2d5p3jFkDCcGI
</span></span><span class=line><span class=cl>  <span class=m>51</span>   │ <span class=p>|</span> +Y0tZRIRzHWgQHa/
</span></span><span class=line><span class=cl>  <span class=m>52</span>   │ <span class=p>|</span>_-----END CERTIFICATE-----
</span></span></code></pre></div><p>We have two open ports, one with <strong>http</strong> and one with <strong>https</strong>.</p><h2 id=enumeration>Enumeration<a hidden class=anchor aria-hidden=true href=#enumeration>#</a></h2><p>When I access to the http page seems to redirect you to the ssl one.</p><p><img loading=lazy src=/HTB/sense-1.png alt=Untitled></p><p>This will be our only point of entry. If we look at the page there is a pfsense login form.</p><p>Investigating on google I found that pfsense is a firewall/router computer software distribution based on FreeBSD.</p><p>Searching for default credentials, I found admin/pfsense.</p><p><img loading=lazy src=/HTB/sense-2.png alt=Untitled></p><p>I am not able to access with them so maybe they changed the passwords.</p><p>Only I can do now is to fuzz in order to obtain something else.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>   <span class=m>1</span>   │ /index.html/          <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 329<span class=o>]</span>
</span></span><span class=line><span class=cl>   <span class=m>2</span>   │ /index.php/           <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 6690<span class=o>]</span>
</span></span><span class=line><span class=cl>   <span class=m>3</span>   │ /help.php/            <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 6689<span class=o>]</span>
</span></span><span class=line><span class=cl>   <span class=m>4</span>   │ /stats.php/           <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 6690<span class=o>]</span>
</span></span><span class=line><span class=cl>   <span class=m>5</span>   │ /edit.php/            <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 6689<span class=o>]</span>
</span></span><span class=line><span class=cl>   <span class=m>6</span>   │ /license.php/         <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 6692<span class=o>]</span>
</span></span><span class=line><span class=cl>   <span class=m>7</span>   │ /system.php/          <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 6691<span class=o>]</span>
</span></span><span class=line><span class=cl>   <span class=m>8</span>   │ /status.php/          <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 6691<span class=o>]</span>
</span></span><span class=line><span class=cl>   <span class=m>9</span>   │ /changelog.txt/       <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 271<span class=o>]</span>
</span></span><span class=line><span class=cl>  <span class=m>10</span>   │ /system-users.txt/    <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 100<span class=o>]</span>
</span></span><span class=line><span class=cl>  <span class=m>11</span>   │ /exec.php/            <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 6689<span class=o>]</span>
</span></span><span class=line><span class=cl>  <span class=m>12</span>   │ /graph.php/           <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 6690<span class=o>]</span>
</span></span><span class=line><span class=cl>  <span class=m>13</span>   │ /tree/                <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 7492<span class=o>]</span>
</span></span><span class=line><span class=cl>  <span class=m>14</span>   │ /gui.css/             <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 6590<span class=o>]</span>
</span></span><span class=line><span class=cl>  <span class=m>15</span>   │ /wizard.php/          <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 6691<span class=o>]</span>
</span></span><span class=line><span class=cl>  <span class=m>16</span>   │ /pkg.php/             <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 6688<span class=o>]</span>
</span></span><span class=line><span class=cl>  <span class=m>17</span>   │ /installer/           <span class=o>(</span>Status: 302<span class=o>)</span> <span class=o>[</span>Size: 0<span class=o>]</span> <span class=o>[</span>--&gt; installer.php<span class=o>]</span>
</span></span><span class=line><span class=cl>  <span class=m>18</span>   │ /xmlrpc.php/          <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 384<span class=o>]</span>
</span></span><span class=line><span class=cl>  <span class=m>19</span>   │ /treeview.css/        <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 726<span class=o>]</span>
</span></span></code></pre></div><p>The scan results gives us two interesting directories /changelog.txt and /system-users.txt</p><p><img loading=lazy src=/HTB/sense-3.png alt=Untitled></p><p>In /changelog.txt directory we found information about security stuff, basically told us that there is one vulnerability which it isn’t patched yet.</p><p><img loading=lazy src=/HTB/sense-4.png alt=Untitled></p><p>The /system-users.txt gives us a. credentials, maybe we can try to access with them in the main login page.</p><h2 id=exploiting>Exploiting<a hidden class=anchor aria-hidden=true href=#exploiting>#</a></h2><p><img loading=lazy src=/HTB/sense-5.png alt=Untitled></p><p>We have the current software version of pfsense which we are using. Let’s search any exploit.</p><p><img loading=lazy src=/HTB/sense-6.png alt=Untitled></p><p>We only have one which seems a command injection vuln.</p><p><img loading=lazy src=/HTB/sense-8.png alt=Untitled></p><p>The exploit seems to automatize the things.</p><p><img loading=lazy src=/HTB/sense-7.png alt=Untitled></p><p>The script doesn’t worked for me, so I decided to see how works to gain access by myself.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nv>exploit_url</span> <span class=o>=</span> <span class=s2>&#34;https://&#34;</span> + rhost + <span class=s2>&#34;/status_rrd_graph_img.php?database=queues;&#34;</span>+<span class=s2>&#34;printf+&#34;</span> + <span class=s2>&#34;&#39;&#34;</span> + payload + <span class=s2>&#34;&#39;|sh&#34;</span>
</span></span></code></pre></div><p>The script basically access to the above url and put a payload with a reverse shell, so let’s make it with burp repeater.</p><p>The following requests seems to work, its a basic injection to ensure that we have command injection</p><p><img loading=lazy src=/HTB/sense-9.png alt=Untitled></p><p>Once insured about that there is a command injection. Let’s see what user is executing the commands, I put a nc listener in order to see the output.</p><p><img loading=lazy src=/HTB/sense-10.png alt=Untitled></p><p><img loading=lazy src=/HTB/sense-11.png alt=Untitled></p><p>Good we are root so let’s put a reverse shell to gain access to the machine.</p><p><img loading=lazy src=/HTB/sense-12.png alt=Untitled></p><p>Something is not working, maybe some kind of character is not covered</p><p><img loading=lazy src=/HTB/sense-13.png alt=Untitled></p><p>With the above injection the <code>/</code> character is not outputted.</p><p>I tried the same injection with a bunch of characters and the ones are not outputted are <code>/</code> and <code>-</code></p><p>We can pass this characters octal code to a variable and use the variable in order to execute the reverse shell.</p><p><img loading=lazy src=/HTB/sense-14.png alt=Untitled></p><h2 id=gaining-an-initial-foothold>Gaining an Initial Foothold<a hidden class=anchor aria-hidden=true href=#gaining-an-initial-foothold>#</a></h2><p><img loading=lazy src=/HTB/sense-15.png alt=Untitled></p><p>We owned the system, this machine doesn’t need privesc as we can see.</p><p>Let’s cat the <strong>user’s flag</strong>.</p><p><img loading=lazy src=/HTB/sense-16.png alt=Untitled></p><p>Let’s cat the <strong>root’s flag</strong>.</p><p><img loading=lazy src=/HTB/sense-17.png alt=Untitled></p><p><strong>Thank you for reading, and happy hacking! 😄</strong></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://pwndside.github.io/tags/privesc/>privesc</a></li><li><a href=https://pwndside.github.io/tags/web/>web</a></li><li><a href=https://pwndside.github.io/tags/linux/>linux</a></li></ul><nav class=paginav><a class=prev href=https://pwndside.github.io/posts/node-htb/><span class=title>« Prev</span><br><span>Node</span></a>
<a class=next href=https://pwndside.github.io/posts/solidstate-htb/><span class=title>Next »</span><br><span>Solidstate</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Sense on twitter" href="https://twitter.com/intent/tweet/?text=Sense&amp;url=https%3a%2f%2fpwndside.github.io%2fposts%2fsense-htb%2f&amp;hashtags=privesc%2cweb%2clinux"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Sense on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fpwndside.github.io%2fposts%2fsense-htb%2f&amp;title=Sense&amp;summary=Sense&amp;source=https%3a%2f%2fpwndside.github.io%2fposts%2fsense-htb%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Sense on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fpwndside.github.io%2fposts%2fsense-htb%2f&title=Sense"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Sense on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fpwndside.github.io%2fposts%2fsense-htb%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Sense on whatsapp" href="https://api.whatsapp.com/send?text=Sense%20-%20https%3a%2f%2fpwndside.github.io%2fposts%2fsense-htb%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Sense on telegram" href="https://telegram.me/share/url?text=Sense&amp;url=https%3a%2f%2fpwndside.github.io%2fposts%2fsense-htb%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://pwndside.github.io/>PwndSide</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>